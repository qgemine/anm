from numpy import array, ceil
from models import LoadSampler

def case33(flex_level = 'MEDIUM'):

    case = {"version": 'ANM'}
    ## system MVA base
    case["baseMVA"] = 100.0
    ## Bus data
    case["bus"] = array([
        [1, 3, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [2, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [3, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [4, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [5, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [6, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [7, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [8, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [9, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [10, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [11, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [12, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [13, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [14, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [15, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [16, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [17, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [18, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [19, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [20, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [21, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [22, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [23, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [24, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [25, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [26, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [27, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [28, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [29, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [30, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [31, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [32, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9],
        [33, 1, 0.0, 0.0, 0.0, 0.0, 1, 1.0, 0.0, 12.66, 1, 1.05, 0.9]
    ])
    ## Gen data
    case["gen"] = array([
        [ 1,    0.0,    0.0,    100,   -100,   1.02,    100,      1,    100,   -100,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [ 2,     -1,   -0.6,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [ 3,     -1,  -0.44,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [ 4,     -1,  -0.66,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [ 5,     -1,   -0.5,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [ 6,     -1,  -0.33,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [ 7,     -1,   -0.5,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [ 8,     -1,   -0.5,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [ 9,     -1,  -0.33,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [10,     -1,  -0.33,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [11,     -1,  -0.66,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [12,     -1,  -0.58,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [13,     -1,  -0.58,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [14,     -1,  -0.66,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [15,     -1,  -0.16,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [16,     -1,  -0.33,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [17,     -1,  -0.33,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [18,     -1,  -0.44,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [19,     -1,  -0.44,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [20,     -1,  -0.44,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [21,     -1,  -0.44,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [22,     -1,  -0.44,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [23,     -1,  -0.55,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [24,     -1,  -0.47,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [25,     -1,  -0.47,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [26,     -1,  -0.41,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [27,     -1,  -0.41,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [28,     -1,  -0.33,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [29,     -1,  -0.58,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [30,     -1,     -3,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [31,     -1,  -0.46,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [32,     -1,  -0.47,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [33,     -1,  -0.66,      0,      0,      0,    100,      1,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0,      0],
        [19,      1,      0,      1,     -1,     0.0,    100,      1,    4.5,      0,      1,    4.5,   -1.1,    1.1,   -0.4,    0.4,      0,      0,      0,      0,      0],
        [ 4,      1,      0,      1,     -1,     0.0,    100,      1,    4.5,      0,      1,    4.5,   -1.1,    1.1,   -0.4,    0.4,      0,      0,      0,      0,      0],
        [23,      1,      0,      1,     -1,     0.0,    100,      1,    4.5,      0,      1,    4.5,   -1.1,    1.1,   -0.4,    0.4,      0,      0,      0,      0,      0],
        [22,      1,      0,      1,     -1,     0.0,    100,      1,    4.5,      0,      1,    4.5,   -1.1,    1.1,   -0.4,    0.4,      0,      0,      0,      0,      0]
    ])
    ## Branch data
    case["branch"] = array([
        [1, 2, 0.0575, 0.0297, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [2, 3, 0.1538, 0.0783, 0.0, 13.32, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0], # 13.32
        [3, 4, 0.1141, 0.0574, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [4, 5, 0.1189, 0.0605, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [5, 6, 0.2555, 0.0218, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [6, 7, 0.1168, 0.3861, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [7, 8, 1.0679, 0.7707, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],#
        [8, 9, 0.6427, 0.4617, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [9, 10, 0.6489, 0.4617, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],#
        [10, 11, 0.1226, 0.0405, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [11, 12, 0.2336, 0.0772, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [12, 13, 0.916, 0.7207, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [13, 14, 0.3379, 0.4448, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [14, 15, 0.3687, 0.3282, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],#
        [15, 16, 0.4656, 0.34, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [16, 17, 0.8043, 1.0739, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [17, 18, 0.4567, 0.3581, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [2, 19, 0.0511, 0.0488, 0.0, 6.66, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0], # 6.66
        [19, 20, 0.9386, 0.8457, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [20, 21, 0.2555, 0.2985, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [21, 22, 0.4423, 0.5848, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [3, 23, 0.1407, 0.0961, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [23, 24, 0.5603, 0.4424, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [24, 25, 0.5591, 0.4374, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [6, 26, 0.0633, 0.0322, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [26, 27, 0.1773, 0.0902, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [27, 28, 0.6608, 0.5826, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [28, 29, 0.5018, 0.4371, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [29, 30, 0.3166, 0.1613, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [30, 31, 0.608, 0.6009, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [31, 32, 0.1937, 0.2258, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [32, 33, 0.2127, 0.3308, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],#
        [21, 8, 1.248, 1.248, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [9, 15, 1.248, 1.248, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [12, 22, 1.248, 1.248, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [18, 33, 0.312, 0.312, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0],
        [25, 29, 0.312, 0.312, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1, -360.0, 360.0]#
    ])

    ## List of all potential flexible services of loads.
    # Type, device, price, signal
    flex_conso = [
        [1,  1, 1.62, [0.016885448916408665, 0.0386609907120743, 0.05199380804953561, 0.054000000000000006, 0.04421981424148608, 0.024826625386996905, -0.0, -0.024826625386996905, -0.04421981424148608, -0.054000000000000006, -0.05199380804953561, -0.0386609907120743, -0.016885448916408665]],
        [1,  2, 1.458, [-0.015031224127735067, -0.026297457125960967, -0.035839266706091076, -0.04302436428149024, -0.047364163217031345, -0.048600000000000004, -0.046645653459491426, -0.0416448255470136, -0.0338849201655825, -0.023912004730928443, -0.012358367829686577, 0.0, 0.012358367829686577, 0.023912004730928443, 0.0338849201655825, 0.0416448255470136, 0.046645653459491426, 0.048600000000000004, 0.047364163217031345, 0.04302436428149024, 0.035839266706091076, 0.026297457125960967, 0.015031224127735067]],
        [1,  3, 1.944, [0.0202625386996904, 0.040625386996904024, 0.055922600619195045, 0.0643486068111455, 0.0648, 0.05722662538699689, 0.0425814241486068, 0.022720123839009287, -0.0, -0.022720123839009287, -0.0425814241486068, -0.05722662538699689, -0.0648, -0.0643486068111455, -0.055922600619195045, -0.040625386996904024, -0.0202625386996904]],
        [1,  4, 0.972, [-0.010092435973793924, -0.02516354973198332, -0.0324, -0.029544014294222754, -0.017502561048243, 0.0, 0.017502561048243, 0.029544014294222754, 0.0324, 0.02516354973198332, 0.010092435973793924]],
        [1,  5, 0.972, [0.010007339449541283, 0.01904862385321101, 0.02620733944954128, 0.03081467889908256, 0.0324, 0.03081467889908256, 0.02620733944954128, 0.01904862385321101, 0.010007339449541283, -0.0, -0.010007339449541283, -0.01904862385321101, -0.02620733944954128, -0.03081467889908256, -0.0324, -0.03081467889908256, -0.02620733944954128, -0.01904862385321101, -0.010007339449541283]],
        [1,  6, 3.24, [-0.0334819205690575, -0.06529934795494961, -0.08994665085951396, -0.10473503260225253, -0.10800000000000001, -0.09948547717842326, -0.08002371072910493, -0.05185536455246001, -0.017925311203319506, 0.017925311203319506, 0.05185536455246001, 0.08002371072910493, 0.09948547717842326, 0.10800000000000001, 0.10473503260225253, 0.08994665085951396, 0.06529934795494961, 0.0334819205690575]],
        [1,  7, 3.24, [0.03383333333333334, 0.06766666666666668, 0.09325000000000001, 0.10725000000000003, 0.10800000000000001, 0.09541666666666669, 0.07100000000000001, 0.037833333333333344, -0.0, -0.037833333333333344, -0.07100000000000001, -0.09541666666666669, -0.10800000000000001, -0.10725000000000003, -0.09325000000000001, -0.06766666666666668, -0.03383333333333334]],
        [1,  8, 0.972, [-0.01003386727688787, -0.021328146453089242, -0.02921189931350114, -0.0324, -0.030348741418764303, -0.02342883295194508, -0.012752402745995423, 0.0, 0.012752402745995423, 0.02342883295194508, 0.030348741418764303, 0.0324, 0.02921189931350114, 0.021328146453089242, 0.01003386727688787]],
        [1,  9, 0.972, [0.010174390243902438, 0.023213414634146338, 0.031214634146341458, 0.0324, 0.026571951219512193, 0.014915853658536583, -0.0, -0.014915853658536583, -0.026571951219512193, -0.0324, -0.031214634146341458, -0.023213414634146338, -0.010174390243902438]],
        [1, 10, 0.729, [-0.007601158536585367, -0.017395243902439024, -0.02339615853658537, -0.024300000000000002, -0.019899329268292684, -0.011172073170731706, 0.0, 0.011172073170731706, 0.019899329268292684, 0.024300000000000002, 0.02339615853658537, 0.017395243902439024, 0.007601158536585367]],
        [1, 11, 0.972, [0.010094819020581972, 0.025156564939673526, 0.0324, 0.0295486160397445, 0.017499219304471254, -0.0, -0.017499219304471254, -0.0295486160397445, -0.0324, -0.025156564939673526, -0.010094819020581972]],
        [1, 12, 0.972, [-0.010284598698481561, -0.024504989154013012, -0.0324, -0.031908026030368755, -0.02319305856832972, -0.008457266811279826, 0.008457266811279826, 0.02319305856832972, 0.031908026030368755, 0.0324, 0.024504989154013012, 0.010284598698481561]],
        [1, 13, 1.944, [0.020189638041163943, 0.0648, 0.03499843860894251, -0.03499843860894251, -0.0648, -0.020189638041163943]],
        [1, 14, 0.972, [-0.010046748350612629, -0.019589632422243167, -0.026979641847313853, -0.03140754005655042, -0.0324, -0.02985014137606032, -0.024017530631479732, -0.015543449575871818, -0.005374552309142319, 0.005374552309142319, 0.015543449575871818, 0.024017530631479732, 0.02985014137606032, 0.0324, 0.03140754005655042, 0.026979641847313853, 0.019589632422243167, 0.010046748350612629]],
        [1, 15, 0.972, [0.01028422575976845, 0.02450709117221418, 0.0324, 0.03191548480463096, 0.023178581765557156, 0.008455571635311143, -0.008455571635311143, -0.023178581765557156, -0.03191548480463096, -0.0324, -0.02450709117221418, -0.01028422575976845]],
        [1, 16, 0.972, [-0.010095319148936169, -0.02081872340425532, -0.028616170212765954, -0.0324, -0.03163404255319149, -0.026425531914893614, -0.01749446808510638, -0.006112340425531914, 0.006112340425531914, 0.01749446808510638, 0.026425531914893614, 0.03163404255319149, 0.0324, 0.028616170212765954, 0.02081872340425532, 0.010095319148936169]],
        [1, 17, 1.458, [0.015420028887818968, 0.03676003851709196, 0.048600000000000004, 0.04787462686567165, 0.034771112181030336, 0.012682330284063554, -0.012682330284063554, -0.034771112181030336, -0.04787462686567165, -0.048600000000000004, -0.03676003851709196, -0.015420028887818968]],
        [1, 18, 1.458, [-0.015035517970401695, -0.031989006342494714, -0.04380507399577167, -0.048600000000000004, -0.045517547568710355, -0.035139957716701906, -0.019111205073995774, 0.0, 0.019111205073995774, 0.035139957716701906, 0.045517547568710355, 0.048600000000000004, 0.04380507399577167, 0.031989006342494714, 0.015035517970401695]],
        [1, 19, 1.458, [0.015067372881355932, 0.029379661016949152, 0.0404656779661017, 0.047124152542372885, 0.048600000000000004, 0.044755932203389824, 0.036003813559322036, 0.023304661016949155, 0.008065677966101694, -0.008065677966101694, -0.023304661016949155, -0.036003813559322036, -0.044755932203389824, -0.048600000000000004, -0.047124152542372885, -0.0404656779661017, -0.029379661016949152, -0.015067372881355932]],
        [1, 20, 1.458, [-0.015142228530872959, -0.031215755855216465, -0.04290872959545777, -0.048600000000000004, -0.047427253371185245, -0.039631937544357704, -0.026248828956706882, -0.009175017743080199, 0.009175017743080199, 0.026248828956706882, 0.039631937544357704, 0.047427253371185245, 0.048600000000000004, 0.04290872959545777, 0.031215755855216465, 0.015142228530872959]],
        [1, 21, 1.458, [0.015041768579492002, 0.033123894637817494, 0.04505672624647225, 0.048600000000000004, 0.04306792097836312, 0.029534901222953904, 0.01049266227657573, -0.01049266227657573, -0.029534901222953904, -0.04306792097836312, -0.048600000000000004, -0.04505672624647225, -0.033123894637817494, -0.015041768579492002]],
        [1, 22, 1.458, [-0.016053614457831326, -0.046770180722891574, -0.048600000000000004, -0.020396385542168674, 0.020396385542168674, 0.048600000000000004, 0.046770180722891574, 0.016053614457831326]],
        [1, 23, 6.81, [0.07023145539906105, 0.15474366197183098, 0.210481220657277, 0.227, 0.2012093896713615, 0.13790516431924882, 0.04902347417840376, -0.04902347417840376, -0.13790516431924882, -0.2012093896713615, -0.227, -0.210481220657277, -0.15474366197183098, -0.07023145539906105]],
        [1, 24, 6.81, [-0.07072955082742317, -0.14585957446808512, -0.20048983451536642, -0.227, -0.2216335697399527, -0.18514184397163122, -0.12256926713947991, -0.04282411347517731, 0.04282411347517731, 0.12256926713947991, 0.18514184397163122, 0.2216335697399527, 0.227, 0.20048983451536642, 0.14585957446808512, 0.07072955082742317]],
        [1, 25, 0.972, [0.010294468085106381, 0.02451829787234043, 0.0324, 0.031917446808510636, 0.023185531914893618, 0.008456170212765958, -0.008456170212765958, -0.023185531914893618, -0.031917446808510636, -0.0324, -0.02451829787234043, -0.010294468085106381]],
        [1, 26, 0.972, [-0.01001900826446281, -0.026219008264462808, -0.0324, -0.026219008264462808, -0.01001900826446281, 0.01001900826446281, 0.026219008264462808, 0.0324, 0.026219008264462808, 0.01001900826446281]],
        [1, 27, 0.972, [0.010025913163335629, 0.021324603721571328, 0.029206891798759474, 0.0324, 0.030345692625775317, 0.023423569951757404, 0.01275010337698139, -0.0, -0.01275010337698139, -0.023423569951757404, -0.030345692625775317, -0.0324, -0.029206891798759474, -0.021324603721571328, -0.010025913163335629]],
        [1, 28, 1.944, [-0.020051826326671258, -0.03505720192970365, -0.04778497587870434, -0.0573419710544452, -0.06314762232942797, -0.0648, -0.062209786354238454, -0.05551095796002756, -0.045194762232942796, -0.03188642315644383, -0.016479117849758786, 0.0, 0.016479117849758786, 0.03188642315644383, 0.045194762232942796, 0.05551095796002756, 0.062209786354238454, 0.0648, 0.06314762232942797, 0.0573419710544452, 0.04778497587870434, 0.03505720192970365, 0.020051826326671258]],
        [1, 29, 3.24, [0.03379729098552079, 0.07733021952358711, 0.10401494628678187, 0.10800000000000001, 0.0884782811770201, 0.0496366184026156, -0.0, -0.0496366184026156, -0.0884782811770201, -0.10800000000000001, -0.10401494628678187, -0.07733021952358711, -0.03379729098552079]],
        [1, 30, 2.43, [-0.025054612207434608, -0.04304635153740248, -0.058473152822395597, -0.07036851766865534, -0.07802615878843507, -0.08100000000000002, -0.07910417622762735, -0.07245020651675081, -0.061446994033960534, -0.04672648003671409, -0.02921798990362552, -0.009925195043597982, 0.009925195043597982, 0.02921798990362552, 0.04672648003671409, 0.061446994033960534, 0.07245020651675081, 0.07910417622762735, 0.08100000000000002, 0.07802615878843507, 0.07036851766865534, 0.058473152822395597, 0.04304635153740248, 0.025054612207434608]],
        [1, 31, 3.405, [0.03553135160241524, 0.07116813748258245, 0.09800116117045983, 0.1127092429168602, 0.1135, 0.10026799814212728, 0.0746474686483976, 0.03980143985137019, -0.0, -0.03980143985137019, -0.0746474686483976, -0.10026799814212728, -0.1135, -0.1127092429168602, -0.09800116117045983, -0.07116813748258245, -0.03553135160241524]],
        [1, 32, 0.972, [-0.010031051906293062, -0.022101056499770323, -0.030048507119889753, -0.0324, -0.028723932016536516, -0.019704915020670646, -0.006994947175011483, 0.006994947175011483, 0.019704915020670646, 0.028723932016536516, 0.0324, 0.030048507119889753, 0.022101056499770323, 0.010031051906293062]],
    ]

    # Sets of generators and loads from the set of all devices.
    gens = (case["gen"][:,1]>0.0).nonzero()[0]
    loads = (case["gen"][:,1]<0.0).nonzero()[0]

    case["flex"] = []
    # Determine subset of considered flexible services of loads given the flex lvl parameter.
    N_flex = len(flex_conso)
    flex_steps = {
        'NONE':   [],
        'LOW':    range(0,N_flex,3),
        'MEDIUM': range(0,N_flex,3)+range(1,N_flex,3),
        'HIGH':   range(N_flex)
    }
    case["flex"] = []
    for k in flex_steps[flex_level]:
        case["flex"] += [flex_conso[k]]

    # Define the curtailment services for wind generators.
    curt_price = array([45.,  38.,  35.,  31.,  30.,  34.,  41.,  48.,  53.,  55.,  56.,
                        57.,  54.,  51.,  47.,  46.,  47.,  52.,  59.,  60.,  54.,  52.,
                        51.,  49.])

    for gen in gens:
        case["flex"] += [[2, gen, lambda real_time, price_time: curt_price[ceil((price_time-1)/4)]]]

    # Define the stochastic models describing the consumption of loads and the production of generators.
    load_scales = 5.0*array([0.054 ,  0.0486,  0.0648,  0.0324,  0.0324,  0.108 ,  0.108 ,
                            0.0324,  0.0324,  0.0243,  0.0324,  0.0324,  0.0648,  0.0324,
                            0.0324,  0.0324,  0.0486,  0.0486,  0.0486,  0.0486,  0.0486,
                            0.0486,  0.227 ,  0.227 ,  0.0324,  0.0324,  0.0324,  0.0648,
                            0.108 ,  0.081 ,  0.1135,  0.0324])

    case["power"] = []
    for load, scale in zip(loads, load_scales):
        case["power"] += [[load, LoadSampler(scale)]] # Dev id, callable
    for gen in gens:
        case["power"] += [[gen, lambda ir, ws: (4.5/3.)*min(0.015*(ws-3.5)**3,3.0)*(ws>=3.5)*(ws<=25)]] # Dev id, callable

    return case