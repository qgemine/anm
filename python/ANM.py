#!/usr/bin/env python

from numpy import *
from scipy import *
from scipy import optimize
from scipy import sparse
import theano
from theano.tensor.shared_randomstreams import RandomStreams

class Simulator:
    # ANM.Simulator Simulate the system dynamics of the Active Network
    # Management benchmark available at http://www.montefiore.ulg.ac.be/~anm/ .
    # It takes into account the control actions provided by the user and
    # computes the reward associated to every transition.

    # Set system's parameters.
    N_buses = 77
    N_buses = 77
    N_gens = 59
    N_loads = 53
    Y_rows = array([0, 1, 0, 1, 2, 5, 8, 11, 16, 27, 38, 52, 1, 2, 3, 2, 3, 4, 3, 4, 1, 5, 6, 5, 6, 7, 6, 7, 1, 8, 9, 8, 9, 10, 9, 10, 1, 11, 12, 11, 12, 13, 14, 12, 13, 15, 12, 14, 13, 15, 1, 16, 17, 16, 17, 18, 23, 17, 18, 19, 18, 19, 20, 24, 19, 20, 21, 25, 20, 21, 22, 21, 22, 26, 17, 23, 19, 24, 20, 25, 22, 26, 1, 27, 28, 27, 28, 29, 34, 28, 29, 30, 29, 30, 31, 35, 30, 31, 32, 36, 31, 32, 33, 32, 33, 37, 28, 34, 30, 35, 31, 36, 33, 37, 1, 38, 39, 38, 39, 40, 47, 39, 40, 41, 40, 41, 42, 48, 41, 42, 43, 49, 42, 43, 44, 43, 44, 45, 50, 44, 45, 46, 45, 46, 51, 39, 47, 41, 48, 42, 49, 44, 50, 46, 51, 1, 52, 53, 52, 53, 54, 68, 53, 54, 55, 54, 55, 56, 69, 55, 56, 57, 70, 56, 57, 58, 57, 58, 59, 71, 58, 59, 60, 59, 60, 61, 72, 60, 61, 62, 61, 62, 63, 73, 62, 63, 64, 74, 63, 64, 65, 64, 65, 66, 75, 65, 66, 67, 66, 67, 76, 53, 68, 55, 69, 56, 70, 58, 71, 60, 72, 62, 73, 63, 74, 65, 75, 67, 76])
    Y_cols = array([0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5, 6, 6, 6, 7, 7, 8, 8, 8, 9, 9, 9, 10, 10, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 14, 14, 15, 15, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 22, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 27, 28, 28, 28, 28, 29, 29, 29, 30, 30, 30, 30, 31, 31, 31, 31, 32, 32, 32, 33, 33, 33, 34, 34, 35, 35, 36, 36, 37, 37, 38, 38, 38, 39, 39, 39, 39, 40, 40, 40, 41, 41, 41, 41, 42, 42, 42, 42, 43, 43, 43, 44, 44, 44, 44, 45, 45, 45, 46, 46, 46, 47, 47, 48, 48, 49, 49, 50, 50, 51, 51, 52, 52, 52, 53, 53, 53, 53, 54, 54, 54, 55, 55, 55, 55, 56, 56, 56, 56, 57, 57, 57, 58, 58, 58, 58, 59, 59, 59, 60, 60, 60, 60, 61, 61, 61, 62, 62, 62, 62, 63, 63, 63, 63, 64, 64, 64, 65, 65, 65, 65, 66, 66, 66, 67, 67, 67, 68, 68, 69, 69, 70, 70, 71, 71, 72, 72, 73, 73, 74, 74, 75, 75, 76, 76])
    Y_data = array([ 0.00000000 -238.0952j , 0.00000000 +238.0952j , 0.00000000 +238.0952j , 4770.20667857-3544.87206071j, -386.82149649 +200.43351339j, -386.82149649 +200.43351339j, -386.82149649 +200.43351339j, -296.39587078 +153.54643231j, -842.28282387 +648.95347772j, -842.28282387 +648.95347772j, -684.67324958 +527.13120415j, -944.10742097 +726.89172863j, -386.82149649 +200.43351339j, 773.64299299 -400.86702679j, -386.82149649 +200.43351339j, -386.82149649 +200.43351339j, 1878.65942169 -606.86371737j, -1491.83792520 +406.43020398j, -1491.83792520 +406.43020398j, 1491.83792520 -406.43020398j, -386.82149649 +200.43351339j, 773.64299299 -400.86702679j, -386.82149649 +200.43351339j, -386.82149649 +200.43351339j, 1878.65942169 -606.86371737j, -1491.83792520 +406.43020398j, -1491.83792520 +406.43020398j, 1491.83792520 -406.43020398j, -386.82149649 +200.43351339j, 773.64299299 -400.86702679j, -386.82149649 +200.43351339j, -386.82149649 +200.43351339j, 1878.65942169 -606.86371737j, -1491.83792520 +406.43020398j, -1491.83792520 +406.43020398j, 1491.83792520 -406.43020398j, -296.39587078 +153.54643231j, 592.79174156 -307.09286461j, -296.39587078 +153.54643231j, -296.39587078 +153.54643231j, 1997.54501985 -688.47384515j, -296.39587078 +153.54643231j, -1404.75327829 +381.38098053j, -296.39587078 +153.54643231j, 1701.14914907 -534.92741284j, -1404.75327829 +381.38098053j, -1404.75327829 +381.38098053j, 1404.75327829 -381.38098053j, -1404.75327829 +381.38098053j, 1404.75327829 -381.38098053j, -842.28282387 +648.95347772j, 1684.56564775-1297.90695545j, -842.28282387 +648.95347772j, -842.28282387 +648.95347772j, 3403.16552789-1764.02168309j, -842.28282387 +648.95347772j, -1718.59988014 +466.11472764j, -842.28282387 +648.95347772j, 1684.56564775-1297.90695545j, -842.28282387 +648.95347772j, -842.28282387 +648.95347772j, 3403.16552789-1764.02168309j, -842.28282387 +648.95347772j, -1718.59988014 +466.11472764j, -842.28282387 +648.95347772j, 3403.16552789-1764.02168309j, -842.28282387 +648.95347772j, -1718.59988014 +466.11472764j, -842.28282387 +648.95347772j, 1684.56564775-1297.90695545j, -842.28282387 +648.95347772j, -842.28282387 +648.95347772j, 2560.88270402-1115.06820536j, -1718.59988014 +466.11472764j, -1718.59988014 +466.11472764j, 1718.59988014 -466.11472764j, -1718.59988014 +466.11472764j, 1718.59988014 -466.11472764j, -1718.59988014 +466.11472764j, 1718.59988014 -466.11472764j, -1718.59988014 +466.11472764j, 1718.59988014 -466.11472764j, -842.28282387 +648.95347772j, 1684.56564775-1297.90695545j, -842.28282387 +648.95347772j, -842.28282387 +648.95347772j, 3403.16552789-1764.02168309j, -842.28282387 +648.95347772j, -1718.59988014 +466.11472764j, -842.28282387 +648.95347772j, 1684.56564775-1297.90695545j, -842.28282387 +648.95347772j, -842.28282387 +648.95347772j, 3403.16552789-1764.02168309j, -842.28282387 +648.95347772j, -1718.59988014 +466.11472764j, -842.28282387 +648.95347772j, 3403.16552789-1764.02168309j, -842.28282387 +648.95347772j, -1718.59988014 +466.11472764j, -842.28282387 +648.95347772j, 1684.56564775-1297.90695545j, -842.28282387 +648.95347772j, -842.28282387 +648.95347772j, 2560.88270402-1115.06820536j, -1718.59988014 +466.11472764j, -1718.59988014 +466.11472764j, 1718.59988014 -466.11472764j, -1718.59988014 +466.11472764j, 1718.59988014 -466.11472764j, -1718.59988014 +466.11472764j, 1718.59988014 -466.11472764j, -1718.59988014 +466.11472764j, 1718.59988014 -466.11472764j, -684.67324958 +527.13120415j, 1369.34649917-1054.2624083j , -684.67324958 +527.13120415j, -684.67324958 +527.13120415j, 3000.46748778-1497.0360567j , -684.67324958 +527.13120415j, -1631.12098861 +442.7736484j , -684.67324958 +527.13120415j, 1369.34649917-1054.2624083j , -684.67324958 +527.13120415j, -684.67324958 +527.13120415j, 3000.46748778-1497.0360567j , -684.67324958 +527.13120415j, -1631.12098861 +442.7736484j , -684.67324958 +527.13120415j, 3000.46748778-1497.0360567j , -684.67324958 +527.13120415j, -1631.12098861 +442.7736484j , -684.67324958 +527.13120415j, 1369.34649917-1054.2624083j , -684.67324958 +527.13120415j, -684.67324958 +527.13120415j, 3000.46748778-1497.0360567j , -684.67324958 +527.13120415j, -1631.12098861 +442.7736484j , -684.67324958 +527.13120415j, 1369.34649917-1054.2624083j , -684.67324958 +527.13120415j, -684.67324958 +527.13120415j, 2315.79423820 -969.90485255j, -1631.12098861 +442.7736484j , -1631.12098861 +442.7736484j , 1631.12098861 -442.7736484j , -1631.12098861 +442.7736484j , 1631.12098861 -442.7736484j , -1631.12098861 +442.7736484j , 1631.12098861 -442.7736484j , -1631.12098861 +442.7736484j , 1631.12098861 -442.7736484j , -1631.12098861 +442.7736484j , 1631.12098861 -442.7736484j , -944.10742097 +726.89172863j, 1888.21484194-1453.78345725j, -944.10742097 +726.89172863j, -944.10742097 +726.89172863j, 3165.71661624-1800.7592478j , -944.10742097 +726.89172863j, -1277.50177431 +346.97579055j, -944.10742097 +726.89172863j, 1888.21484194-1453.78345725j, -944.10742097 +726.89172863j, -944.10742097 +726.89172863j, 3165.71661624-1800.7592478j , -944.10742097 +726.89172863j, -1277.50177431 +346.97579055j, -944.10742097 +726.89172863j, 3165.71661624-1800.7592478j , -944.10742097 +726.89172863j, -1277.50177431 +346.97579055j, -944.10742097 +726.89172863j, 1888.21484194-1453.78345725j, -944.10742097 +726.89172863j, -944.10742097 +726.89172863j, 3165.71661624-1800.7592478j , -944.10742097 +726.89172863j, -1277.50177431 +346.97579055j, -944.10742097 +726.89172863j, 1888.21484194-1453.78345725j, -944.10742097 +726.89172863j, -944.10742097 +726.89172863j, 3165.71661624-1800.7592478j , -944.10742097 +726.89172863j, -1277.50177431 +346.97579055j, -944.10742097 +726.89172863j, 1888.21484194-1453.78345725j, -944.10742097 +726.89172863j, -944.10742097 +726.89172863j, 3165.71661624-1800.7592478j , -944.10742097 +726.89172863j, -1277.50177431 +346.97579055j, -944.10742097 +726.89172863j, 3165.71661624-1800.7592478j , -944.10742097 +726.89172863j, -1277.50177431 +346.97579055j, -944.10742097 +726.89172863j, 1888.21484194-1453.78345725j, -944.10742097 +726.89172863j, -944.10742097 +726.89172863j, 3165.71661624-1800.7592478j , -944.10742097 +726.89172863j, -1277.50177431 +346.97579055j, -944.10742097 +726.89172863j, 1888.21484194-1453.78345725j, -944.10742097 +726.89172863j, -944.10742097 +726.89172863j, 2221.60919528-1073.86751918j, -1277.50177431 +346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j, -1277.50177431 +346.97579055j, 1277.50177431 -346.97579055j])
    Y_bus =  sparse.coo_matrix((Y_data, (Y_rows,Y_cols)), shape=(N_buses,N_buses)).toarray()
    d2b_rows = array([1, 3, 4, 6, 7, 9, 10, 11, 13, 14, 15, 17, 20, 22, 23, 24, 25, 26, 28, 31, 33, 34, 35, 36, 37, 39, 42, 44, 46, 47, 48, 49, 50, 51, 53, 54, 56, 57, 58, 60, 61, 63, 64, 65, 67, 68, 69, 70, 71, 72, 73, 74, 75, 1, 3, 4, 6, 7, 9, 10, 11, 13, 14, 15, 17, 20, 22, 23, 24, 25, 26, 28, 31, 33, 34, 35, 36, 37, 39, 42, 44, 46, 47, 48, 49, 50, 51, 53, 54, 56, 57, 58, 60, 61, 63, 64, 65, 67, 68, 69, 70, 71, 72, 73, 74, 75, 2, 5, 8, 16, 27, 52])
    d2b_cols = array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111])
    d2b_data = array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
    dev2bus = sparse.coo_matrix((d2b_data, (d2b_rows, d2b_cols)), shape=(76, 112)).toarray()
    qp = tan(arccos(0.98))*ones(112)
    g_ij = array([0,386.821496494312,386.821496494312,1491.83792519772,386.821496494312,386.821496494312,1491.83792519772,386.821496494312,386.821496494312,1491.83792519772,296.395870782097,296.395870782097,296.395870782097,1404.75327828734,1404.75327828734,842.282823874705,842.282823874705,842.282823874705,842.282823874705,842.282823874705,842.282823874705,842.282823874705,1718.59988014193,1718.59988014193,1718.59988014193,1718.59988014193,842.282823874705,842.282823874705,842.282823874705,842.282823874705,842.282823874705,842.282823874705,842.282823874705,1718.59988014193,1718.59988014193,1718.59988014193,1718.59988014193,684.673249584679,684.673249584679,684.673249584679,684.673249584679,684.673249584679,684.673249584679,684.673249584679,684.673249584679,684.673249584679,1631.12098861358,1631.12098861358,1631.12098861358,1631.12098861358,1631.12098861358,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,944.107420968271,1277.50177430802,1277.50177430802,1277.50177430802,1277.50177430802,1277.50177430802,1277.50177430802,1277.50177430802,1277.50177430802,1277.50177430802])
    b_ij = array([-238.0952,-200.433513394501,-200.433513394501,-406.430203980147,-200.433513394501,-200.433513394501,-406.430203980147,-200.433513394501,-200.433513394501,-406.430203980147,-153.546432307417,-153.546432307417,-153.546432307417,-381.380980530501,-381.380980530501,-648.953477723598,-648.953477723598,-648.953477723598,-648.953477723598,-648.953477723598,-648.953477723598,-648.953477723598,-466.114727639969,-466.114727639969,-466.114727639969,-466.114727639969,-648.953477723598,-648.953477723598,-648.953477723598,-648.953477723598,-648.953477723598,-648.953477723598,-648.953477723598,-466.114727639969,-466.114727639969,-466.114727639969,-466.114727639969,-527.131204151345,-527.131204151345,-527.131204151345,-527.131204151345,-527.131204151345,-527.131204151345,-527.131204151345,-527.131204151345,-527.131204151345,-442.773648397731,-442.773648397731,-442.773648397731,-442.773648397731,-442.773648397731,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-726.891728625195,-346.975790552796,-346.975790552796,-346.975790552796,-346.975790552796,-346.975790552796,-346.975790552796,-346.975790552796,-346.975790552796,-346.975790552796])
    links = array([[0,1],[1,2],[2,3],[3,4],[1,5],[5,6],[6,7],[1,8],[8,9],[9,10],[1,11],[11,12],[12,13],[12,14],[13,15],[1,16],[16,17],[17,18],[18,19],[19,20],[20,21],[21,22],[17,23],[19,24],[20,25],[22,26],[1,27],[27,28],[28,29],[29,30],[30,31],[31,32],[32,33],[28,34],[30,35],[31,36],[33,37],[1,38],[38,39],[39,40],[40,41],[41,42],[42,43],[43,44],[44,45],[45,46],[39,47],[41,48],[42,49],[44,50],[46,51],[1,52],[52,53],[53,54],[54,55],[55,56],[56,57],[57,58],[58,59],[59,60],[60,61],[61,62],[62,63],[63,64],[64,65],[65,66],[66,67],[53,68],[55,69],[56,70],[58,71],[60,72],[62,73],[63,74],[65,75],[67,76]])
    dPnom = 5*array([-0.02616,0.03384,-0.02616,0.03384,-0.02616,0.03384,-0.02624,0.02624,-0.00664,0.0332,-0.0284,0.0284,-0.0284,0.04256,-0.04256,0.04264,-0.04264,0.0284,-0.0284,0.0284,-0.04256,0.04256,-0.04264,0.04264,-0.02896,0.02904,-0.02904,0.02904,-0.04336,0.0436,-0.0436,0.0436,-0.0436,0.0228,-0.02296,0.02296,-0.02296,0.02296,-0.02296,0.02296,-0.02296,0.02296,-0.02296,0.02296,-0.0376,0.0148,-0.03784,0.01496,-0.03784,0.01496,-0.03784,0.01496,-0.03784])
    Tflex = array([13,23,17,11,19,18,17,15,13,13,11,12,6,18,12,16,12,15,18,16,14,8,14,16,12,10,15,23,13,24,17,14,14,14,15,9,12,10,14,15,17,14,14,7,20,7,24,12,10,17,20,19,17])
    ratings = array([22.5,6.82,6.82,4.84,6.82,6.82,4.84,6.82,6.82,4.84,6.82,6.82,6.82,4.84,4.84,8.86,8.86,8.86,8.86,8.86,8.86,8.86,4.84,4.84,4.84,4.84,8.86,8.86,8.86,8.86,8.86,8.86,8.86,4.84,4.84,4.84,4.84,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,4.84,4.84,4.84,4.84,4.84,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,8.86,4.84,4.84,4.84,4.84,4.84,4.84,4.84,4.84,4.84])
    V_slack = 1.015
    Vmin = 0.95*ones(N_buses-1)
    Vmax = 1.05*ones(N_buses-1)
    V_init = array([V_slack] + [1]*(N_buses-1) + [0]*N_buses)
    curt_price = array([44.6173227472565,37.5933152653731,35.486858835712,30.813577481462,29.7982908484623,34.0830165585145,41.1455693600725,47.9863431328419,52.7878848863657,54.935686142715,56.2104514377951,56.5735353275524,54.2256495551522,50.721523721694,47.4582530137651,45.7213834384578,46.8899775610899,51.958446932519,58.7142978138175,59.8841691269956,53.82313410273,51.7470364162305,50.6788170666746,49.2207084749555])
    ir_to_pv = array([159.4125, 206.2125, 159.4125, 206.2125, 159.4125, 206.2125, 159.9, 159.9, 40.4625, 202.3125, 173.0625, 173.0625, 173.0625, 259.35, 259.35, 259.8375, 259.8375, 173.0625, 173.0625, 173.0625, 259.35, 259.35, 259.8375, 259.8375, 176.475, 176.9625, 176.9625, 176.9625, 264.225, 265.6875, 265.6875, 265.6875, 265.6875, 138.9375, 139.9125, 139.9125, 139.9125, 139.9125, 139.9125, 139.9125, 139.9125, 139.9125, 139.9125, 139.9125, 229.125, 90.1875, 230.5875, 91.1625, 230.5875, 91.1625, 230.5875, 91.1625, 230.5875])

    def __init__(self):
        # __init__ Initialize the data members of the class and 
        # generate the initial state of the system.

        # Initialize consumption of loads
        self.Ploads = self.P_init()/1e6

        # Stochastic initialization of weather's state.
        self.ws = max(4.8272+2.6395*random.normal(), 0)
        self.ir = 0

        # Deduce initial distributed generation from weather data
        self.Pgens = append(self.ir_to_pv*self.ir,[(10.0/6.0)*min(15000.0*(self.ws-3.5)**3,3000000.0)*(self.ws>=3.5)*(self.ws<=25)]*6)/1e6

        # Electrical quantities are not computed initially.
        self.computed = False

        # Initialize state and action vectors.
        self.flex_state = zeros(self.N_loads)
        self.dP_flex = zeros(self.N_loads)
        self.curt_state = 1e2*ones(self.N_gens)
        self.last_flex_act = zeros(self.N_loads)
        self.flex_act = zeros(self.N_loads)
        self.curt_insts = 1e2*ones(self.N_gens)
        self.q = 1

    def getCurtPrice(self, quarter):
        # GETCURTPRICE Get the cost of curtailing generation per MWh 
        # for the specified quarter of an hour the day.
        #   C = GETCURTPRICE(OBJ, QUARTER) or
        #   C = OBJ.GETCURTPRICE(QUARTER) returns in C the cost of
        #   curtailement per MWh for QUARTER that belongs to {1,...,96}.
        
        return self.curt_price[ceil(quarter/4)-1]

    def getCurtState(self):
        # GETCURTSTATE Get the last curtailment instructions, i.e. the
        # power production limits that are currently active.
            
        return self.curt_state

    def getFlexOffsets(self):
        # GETFLEXOFFSETS Get the current offsets in power injections of
        # the flexible loads that is induced by the current modulation.

        return self.dP_flex

    def getFlexState(self):
        # GETFLEXSTATE Get the state (number of active periods left) of
        # flexible loads.
        return self.flex_state
    
    def getI(self):
        # GETI Get the magnitude of the currents in the links of the
        # network, in per unit.
        
        if not self.computed:
            self.comp_elec_state()

        # Get current magnitude [p.u.] in links.
        return self.I
    
    def getPCurtGens(self):
        # GETPCURTGENS Get the active power injection of generators, in
        # MW, accounting for curtailment instructions.
        
        return minimum(self.Pgens, self.curt_state)
    
    def getPGens(self):
        # GETPGENS Get the potential (without curtailment) active power
        # injection of generators, in MW.
        
        return self.Pgens
            
    def getPLoads(self):
        # GETPLOADS Get the baseline (without modulation) active power
        # injection of loads, in MW.
        
        return -self.Ploads
    
    def getPModLoads(self):
        # GETPMODLOADS Get the active power injection of loads, in MW,
        # accounting the modulations.
        
        return -self.Ploads + self.dP_flex
            
    def getQuarter(self):
        # GETQUARTER Get the quarter of an hour in day of the current
        # time period.
        
        return self.q

    def getReward(self):
        # GETREWARD Return the instantaneous reward associeted to the
        # last transition of the system.
        
        if not self.computed:
            self.comp_elec_state()
        
        # Compute last transition's reward
        return -sum(self.curt_price[ceil(self.q/4)-1]*maximum(self.Pgens - self.curt_state, 0.))/4. - sum(15.*self.last_flex_act*abs(self.dPnom)) - sum(1e5*greater(self.Vmagn, self.Vmax)) - sum(1e5*less(self.Vmagn, self.Vmin)) - sum(1e5*greater(self.I, self.ratings))

    def getSolarIr(self):
        # GETSOLARIR Get the current solar irradiance, in W per m^2.
        
        return self.ir
    
    def getV(self):
       # GETV Get the magnitude of the voltages at the buses, in per
       # unit, including the slack bus.
        
        if not self.computed:
            self.comp_elec_state()
        
        return concatenate(([self.V_slack],self.Vmagn))
    
    def getWindSpeed(self):
        # GETWINDSPEED Get the current wind speed, in meters per second.
        
        return self.ws

    def setCurtailment(self, curt_gen):
        # SETCURTAILMENT Set the curtailment instructions for the next
        # period. The shape of the input vector must be (N_gens,).
        
        # Check validity of inputs
        if sum(less(curt_gen, 0)) > 0:
            raise ValueError("Error: a production level upper limit cannot be negative.")
        
        if asarray(curt_gen).shape != asarray(self.curt_state).shape:
            raise ValueError("Error: 'curt_gen' must be a vector (1D) of length 'N_gens'.")
        
        # Update curtailment instructions
        self.curt_insts = asarray(curt_gen)

    def setFlexAct(self, flex_act):
        # SETFLEXACT Set the activation instructions of the flexible
        # services for the next period. The shape of the input vector
        # must be (N_loads,).
        
        # Check validity of inputs
        if asarray(flex_act).shape != self.flex_state.shape:
            raise ValueError("Error: 'flex_act' must be a vector of length N_loads.")
        
        if (sum(greater(flex_act,1)) + sum(less(flex_act,0))) != 0:
            raise ValueError("Error: flex_act' must be a vector of 0's (no activation) and 1's (activation).")
        
        if any(flex_act != floor(flex_act)):
            raise ValueError("Error: 'flex_act' must be a vector of 0's (no activation) and 1's (activation).")
        
        if sum(flex_act*self.flex_state) != 0:
            raise ValueError("Error: trying to activate a flexibility service that is still running.")
        
        # Update activation instructions
        self.flex_act = flex_act;       

    def transition(self):
        # TRANSITION Simulate a transistion of the system, accounting
        # for the control actions provided through SETCURTAILMENT and 
        # SETFLEXACT functions. The reward associated to this
        # transition can be obtained by calling GETREWARD function.
            
        # Electrical state is now out of date.
        self.computed = False

        # Update state of flexible loads.
        self.flex_state = maximum(self.flex_state-1, 0) + self.flex_act*self.Tflex

        # Update curtailment state.
        self.curt_state = self.curt_insts
        
        # Compute value of load modulation signals.
        self.dP_flex = greater(self.flex_state,0)*self.dPnom*sin(1.8*pi*((self.Tflex-self.flex_state+1) - 0.5*(self.Tflex+1))/(self.Tflex-1))

        # Increment the quarter of hour of the day
        self.q = (self.q % 96) + 1

        # Stochastic transition of the consumption of loads.
        Pload_means = self.nn_out(append([self.Ploads*1e6],[[self.q]*self.N_loads],0).T, self.P_means_centering,self.P_means_scaling,self.P_means_w0,self.P_means_offset0,self.P_means_w1,self.P_means_offset1,self.P_means_uncenter,self.P_means_unscale)/1e6
        Pload_stds = self.nn_out(atleast_2d([[self.q]*self.N_loads]).T,atleast_2d(self.P_stds_centering).T,atleast_2d(self.P_stds_scaling).T,atleast_3d(self.P_stds_w0),self.P_stds_offset0,self.P_stds_w1,self.P_stds_offset1,self.P_stds_uncenter,self.P_stds_unscale)/1e6
        self.Ploads = random.normal(Pload_means,maximum(Pload_stds,1e-6))

        # Stochastic transition of the weather (irradiance and wind speed)
        weath_means = self.nn_out([[self.ws,self.q],[self.ir,self.q]],self.weath_means_centering,self.weath_means_scaling,self.weath_means_w0,self.weath_means_offset0,self.weath_means_w1,self.weath_means_offset1,self.weath_means_uncenter,self.weath_means_unscale)
        weath_stds = self.nn_out([[self.q],[self.q]],atleast_2d(self.weath_stds_centering).T,atleast_2d(self.weath_stds_scaling).T,atleast_3d(self.weath_stds_w0),self.weath_stds_offset0,self.weath_stds_w1,self.weath_stds_offset1,self.weath_stds_uncenter,self.weath_stds_unscale)
        [self.ws, self.ir] = maximum(random.normal(weath_means,maximum(weath_stds,1e-6)),0)

        # Distributed generation from weather data
        self.Pgens = append(self.ir_to_pv*self.ir,[(10.0/6.0)*min(15000.0*(self.ws-3.5)**3,3000000.0)*(self.ws>=3.5)*(self.ws<=25)]*6)/1e6

        # Reset instructions for next period.
        self.last_flex_act = self.flex_act
        self.flex_act = zeros(self.N_loads)
        self.curt_insts = 1e2*ones(self.N_gens)

    def comp_elec_state(self):
        # Aggregate power injections at buses
        Pbus = self.dev2bus.dot(concatenate((self.getPModLoads(),self.getPCurtGens())))
        Qbus = self.dev2bus.dot(concatenate((self.getPModLoads(),self.getPCurtGens()))*self.qp)
        
        # Solve power flow equations
        x = optimize.root(self.pf_eqs, self.V_init, args=(self.Y_bus,Pbus,Qbus), method='lm', options={'xtol' : 1e-4}).x
        V_sol = x[0:self.N_buses]+1j*x[self.N_buses:]
        
        # Get the solution
        self.Vmagn = abs(V_sol[1:])
        e = real(V_sol)
        f = imag(V_sol)
        self.I = sqrt( (self.g_ij + self.b_ij)**2 * ( (e[self.links[:,0]]-e[self.links[:,1]])**2 + (f[self.links[:,0]]-f[self.links[:,1]])**2 ) )
        
        # Indicate that the electrical state is now computed.
        self.computed = True

    # Data structures for solving power flow equations
    Vflat = theano.tensor.vector("Vflat")
    V = Vflat[0:N_buses]+1j*Vflat[N_buses:]
    Y = theano.tensor.zmatrix("Y")
    P_inj = theano.tensor.vector("P")
    Q_inj = theano.tensor.vector("Q")
    S_inj = Y.conj().dot(V.conj())*V

    pf_eqs = theano.function([Vflat,Y,P_inj,Q_inj], theano.tensor.concatenate(  (S_inj[1:].real-P_inj
                                                                                ,S_inj[1:].imag-Q_inj
                                                                                ,[V[0].real-V_slack]
                                                                                ,[V[0].imag]) ))
    # Params of functions and random variables used for stochastic transitions
    srng = RandomStreams()
    P_init_mean = [69542.1093, 89285.8933, 69542.1093, 89285.8933, 69542.1093, 89285.8933, 69662.8373, 69662.8373, 17039.0027, 87713.456, 75357.9947, 75357.9947, 75357.9947, 112278.2773, 112278.2773, 112441.9547, 112441.9547, 75357.9947, 75357.9947, 75357.9947, 112278.2773, 112278.2773, 112441.9547, 112441.9547, 76758.5333, 76884.3867, 76884.3867, 76884.3867, 114058.0853, 114667.9573, 114667.9573, 114667.9573, 114667.9573, 60749.976, 60958.7947, 60958.7947, 60958.7947, 60958.7947, 100386.5947, 60958.7947, 60958.7947, 60958.7947, 60958.7947, 60958.7947, 99684.92, 39726.3253, 100386.5947, 39935.144, 100386.5947, 39935.144, 100386.5947, 39935.144, 100386.5947]
    P_init_std = [8618.3644, 7803.1547, 6395.2863, 10225.9181, 7348.6874, 9054.9391, 7462.8012, 6738.1444, 4585.7015, 11361.525, 9092.0135, 10210.7931, 10063.4358, 8895.0148, 8903.4769, 10319.9301, 12074.5085, 8280.0984, 9035.5069, 10876.5701, 7384.6664, 12569.4614, 11359.2309, 9896.597, 10087.8676, 5822.8098, 10320.0791, 9493.182, 11243.2262, 8647.4884, 12568.4498, 8667.831, 10906.4146, 6979.9636, 7756.441, 7177.3051, 7393.594, 6581.5904, 10766.0508, 6780.946, 8822.1733, 8695.8488, 9637.5725, 6992.3361, 7775.9525, 5367.5266, 9779.2269, 6503.8941, 9579.2434, 6749.8151, 9126.0993, 5960.0923, 10378.4643]
    P_init = theano.function([], srng.normal(size=(len(P_init_mean),),avg=P_init_mean,std=P_init_std))

    P_means_w0 = [[[4.07877150348624, -3.56518763871577], [-0.705942888958763, 5.07861410161252], [4.45256557526161, 1.55282799715555], [3.06113297235703, -5.24126674023288], [1.45542574202723, -1.83052549405447], [4.04658403090413, 3.45190145991757], [-3.00678999924973, 4.07556317448791], [-1.4369102623892, -7.08983825576653], [-0.158536549695227, 7.42905802427003], [0.705532307523573, -5.65570058554981], [0.726004242528728, 4.20257073785594], [0.0610375238447974, 7.27238631171774], [0.491590017299839, -4.05348221230043], [-5.79767954936149, 0.791426998877709], [-6.36397757633045, -1.11643168155706]], [[-38.6651542165175, -25.3852153923141], [33.5563465987367, 75.3611007360865], [4.53761183496966, 14.238817939685], [-29.7371766055985, -21.9630165079277], [-3.34564081716221, 2.0804469625485], [15.0530041448616, 25.5824099352215], [37.0115276886021, 0.6663300456509], [-2.8144896058348, 0.516073482499335], [-3.75168825124684, 5.23533630073418], [-1.0944474863618, 8.61982353826999], [-2.04077851098975, 12.5007299938299], [-2.84428504919053, -88.2404202103315], [-0.599597091375673, 6.36682366345908], [-0.129728472541914, 5.11690733847308], [-49.5787788939036, 8.87433403438595]], [[4.48589006568579, -2.78801769025701], [-2.31946281365125, 4.41044486234338], [1.17625971053182, 4.93153330600291], [-3.57510599279708, 3.78916386985699], [-6.32520217517351, -1.2552018151273], [3.87872082007927, -3.74962284416483], [0.717765066527929, 4.45928151528612], [1.59118644728862, -3.7624753404805], [0.0673409815809726, 3.73022791900824], [4.51893805528169, -3.88827896390318], [-3.50587926069908, 3.18290956183074], [-4.29663591936469, 4.02818960204804], [0.0684056183357414, -5.00927799518317], [3.43462051620982, 4.52487452895812], [3.77803201511748, -3.96213759326674]], [[1.26303398515445, -8.4172572241817], [1.74870768519573, 7.85458848375609], [-2.64688722767581, 1.85449905589925], [-1.03417662684916, -2.26281070571183], [1.9499619845973, -12.5100049346669], [2.7497098869563, 0.744370288585963], [-2.1895310371928, 4.31127664937896], [2.6958026680136, -0.119715213407617], [6.15396112070216, -0.681100183459882], [-4.00047737908127, -6.62563672612427], [2.90589524103231, 6.92127995845334], [4.0294453921712, 7.87620942197495], [-7.18277050734098, 6.04481109179154], [0.622081510915309, 7.71367435210894], [5.18618602298109, -5.72150426253058]], [[3.00061195672248, 3.16403214487763], [2.65010186917988, -2.49770888640892], [-11.6580510402164, 6.71418238504071], [-4.74233885649372, -6.10312230008686], [-3.62962466978872, -3.51892010269151], [-6.22019584761155, 5.90719220148881], [-2.17241442182714, 0.599195434332857], [-1.79603833783683, -4.02223419963429], [-4.85987304328318, -4.52789127343023], [1.83978153126195, 8.21962254656736], [-7.29394378102872, -3.19335715263179], [3.92739318640003, -0.124843362345982], [7.1211576841413, 0.467529963162096], [5.65407284070358, 0.732150690362027], [1.88166329684768, 9.91708483860825]], [[-2.74727434188112, 2.68408406321561], [-3.69313790173497, -3.99377294024783], [-4.27552617040658, 0.855048259002884], [-1.04187378397771, -6.0996759416757], [1.35231680101466, 0.855756140458287], [-5.40071876437855, 1.05380623612124], [-10.813547242964, -6.34427176311076], [-2.72876353555449, -1.88921228344568], [6.0871738241764, 0.147164485180142], [-0.951019248647568, 5.87897435766344], [-0.171449089064374, -6.27316895437634], [2.48022935142368, 1.34054157801927], [4.52682023493616, -0.424817620904172], [1.14868928318807, 3.32607835646274], [-5.90009332455465, 0.967444991340238]], [[3.68279474721748, -3.55844487195088], [-1.9344296572331, -12.0794788112321], [-10.1301812593753, -2.31994180400562], [-5.51263250962521, -2.98042136651072], [-0.163752304892008, -6.27320533556657], [2.65234415959586, -18.3430585686587], [-1.51030448926791, -11.5739205534959], [2.30087051625058, 11.6530079472143], [8.23856657117645, -4.35294573234912], [13.2190002492767, 4.25628424941012], [7.06864396522678, -16.3802691714264], [-2.11453307630639, -17.5994184993577], [-6.54750486621127, 5.19764065280984], [4.77890205794922, 10.1309017297043], [0.952968499149779, -0.284772856043297]], [[2.15154078727223, -9.55654963793375], [1.14183883665204, -8.08000975717336], [-0.653007878754242, 3.63244531580975], [3.20052135658061, 0.280944978075966], [0.488409600002089, -9.36684986819163], [-0.681775406292227, 4.41408495410847], [4.5068155517609, 2.1465778914759], [3.28764260015035, 3.33378250134865], [0.773175593595147, -10.6161910534855], [3.10572567534684, 0.5372483471181], [1.4406047508039, 8.68091872127284], [-6.07842412391094, 2.89150079791857], [-0.655899454814428, -7.09314748329683], [-0.134256816647227, 2.53662920064228], [6.42704559815086, -0.655565158196759]], [[2.55187771049152, -4.46661919881968], [-2.69188480785093, -3.8906275822671], [6.15187128917825, 2.93538029138273], [3.13097872175074, -2.73972324739916], [-4.74924791442048, -0.121783210020432], [3.37983915823361, -3.98206056146968], [-1.12067662147656, -4.57986159863495], [5.01648559705152, 2.63748965610602], [-3.70423511809639, 1.43077839771331], [-2.47966233096443, 5.03393648018305], [-7.03712535828975, 1.70378254646464], [4.40354399493919, 0.579035402209174], [-5.68402930054117, -2.26568035408179], [-3.20683407047681, -7.31139528862069], [0.175031283718437, -5.59962912784413]], [[1.70865686928014, -1.75151960284746], [1.5499062248163, 7.11609089186611], [1.12975566628858, 5.85278587228202], [0.927898607038318, 5.03449410043036], [-24.3166463350735, 24.1712576728923], [1.07366976875942, 6.72459007493374], [-1.82754085401679, -12.5517753889214], [8.25033611770979, 14.4309125440938], [0.87400139357227, 0.222787563209496], [2.62725777375411, 8.93019096741944], [11.6454284783414, -0.589726071810351], [-0.579258944529821, -0.751535386308461], [-22.2057753328996, 4.66547869256947], [-6.85138733435813, 6.01026157627617], [25.4403273761595, -31.7869844403831]], [[3.30989024710156, -5.68744106120521], [-7.46249311909062, 0.979585883844956], [1.43756670783483, 3.3209305486994], [-3.99787700601875, -3.82608411426188], [-3.630969984067, -1.35946509423074], [-0.664700747570499, 3.09681942462682], [-3.41236849640028, 3.39991290790236], [-5.77872276682112, -4.92500756892057], [-7.62017269344436, 4.21573288515758], [2.2784125045844, 3.01040483742458], [0.661340606519208, -5.65973448835523], [-2.15252411191023, 0.405717459770492], [3.51559420329693, 3.20979057235167], [4.66918316639071, 0.73805658217576], [-3.67488442974484, -4.33894793103918]], [[3.35137359350655, -4.23788438509957], [-2.13931782963181, -6.9328080448866], [-5.72486364531838, 7.1678376929042], [1.50265578849407, -2.22528409496563], [3.45944001928005, -6.61808407885923], [-4.9242009360772, -7.23332478586376], [1.09067773163202, -9.15325193516441], [-3.25835848314781, -0.858830596516349], [-1.20113213283615, 7.57548971321035], [8.22019956050246, 0.772937954302617], [2.97658579304834, 6.15886132144256], [-0.163509250716862, -5.03725603436993], [0.863547774093415, 9.06853005451266], [-1.90013228549205, -7.9829632221471], [4.37979672113577, -5.78185251257897]], [[-3.65509940754063, -3.12320035160218], [1.87278979769546, 5.91118662230118], [-3.10704342186307, 4.72099031194092], [-6.67661389304964, 9.26004921980328], [-2.26925325815736, -2.63237502668055], [2.13556227788065, 13.2210427830939], [1.25515691058804, -13.6115610465599], [1.94879177666222, 4.89549242767957], [0.606674980788586, 4.57927302774651], [7.31306492315053, 3.66771025783091], [1.61144078448553, -4.12450431802494], [-0.0288654784047972, -2.31942726820446], [-2.68089946673483, -6.94548356661657], [-0.283753720912127, -5.6774901435523], [-1.11965129424116, -10.0602998012176]], [[8.38733524514014, 5.750137115559], [-4.17448486324703, -3.94956285561279], [-6.16345561561313, 5.04144671822132], [-3.28206126655428, -3.40839718669455], [0.614791236172487, 9.08997860986913], [-6.14917329888894, 1.95986676734727], [-4.03466324308457, 1.31454664635274], [6.14523821344512, -4.87671322205194], [-0.783660496827363, -5.4070893089705], [-0.719250099248716, -9.39698246210118], [1.06823655379813, 8.81098593451251], [-2.85285347857711, 3.09446986875883], [-7.37267820230957, 6.59640831712808], [-7.83235038411175, -5.94598574245875], [0.51731099478354, -4.71771256383999]], [[-0.574072805851909, -6.27464328153717], [-1.13533925476906, -4.72120434317425], [1.45454901973893, -3.5583837550894], [-0.458321170653438, -7.77519731888734], [-1.17771463829301, 8.51730555207594], [1.89370473620777, 5.53577681197305], [1.71133504256512, -0.632285218851246], [-3.20153826430823, 2.08175916982388], [-1.59902506676867, 8.22016593336959], [2.21652596870204, -2.76234122709878], [2.33041016723325, -6.09678380531836], [5.20887222623094, -3.46705019622398], [0.163336470069674, 6.07558177040513], [-1.16279620729895, -7.20238750698536], [8.05075034734307, -4.72638108020669]], [[-5.8417944276674, -31.2636414170254], [-0.58085725086883, 0.13569679171342], [-9.8537937745176, -6.53372793052579], [-7.82342028366692, 2.3850689665746], [6.06087945600474, -3.90878061868496], [0.963868959838007, 4.12172654724949], [33.5064017610461, 21.0323665990822], [4.97650689438984, -1.2466391110196], [-1.33556109332734, 6.01527604439028], [0.944651852121652, 4.60917492542342], [1.55192989186544, -5.50038115742755], [4.50744180477839, -1.11947793081749], [1.2124670802635, -6.7493294709367], [0.466821247099912, 8.92789724689407], [0.0378449610908056, -27.6311332776185]], [[-4.65311748109814, 2.61053666324534], [-4.30394699806307, 5.09031018046073], [-3.37525009730263, 4.35601120060799], [-2.26480788748196, -5.87338087380868], [4.95873255797272, -0.0138624305370668], [1.5216472552284, 8.18584494656366], [-5.64126469354007, -1.33064014687131], [-1.42599983267533, 0.537301248157261], [-0.573876290157899, -4.09506165758868], [-6.03539375606892, 4.66727119350696], [-4.65319371861531, 5.02304781328702], [5.34159489972581, 2.10660220565844], [-8.05861958477557, -3.27103342525149], [1.20468247219459, 7.44786390326558], [-0.446706735947607, 6.8374340531691]], [[-2.75599187387698, -2.20099682259505], [0.895290012274917, -6.12302722371428], [4.8289491146459, -0.298217145523803], [-7.43724751839999, 0.0541217485938981], [-1.44905103523651, -7.55156432787643], [0.190788425385788, -11.1105731135226], [-5.48393857454331, 2.47714974359377], [-3.77155271388944, 4.33995963202175], [0.40207119650196, -0.526676114903479], [1.18427653216276, 5.84553889142109], [-1.94263242426331, -8.47904124021136], [-0.721136935618431, -2.86439260078199], [-5.94414512135775, -5.06436433060464], [-5.41664331982766, -2.49516816767431], [10.3711303564824, -3.74978747729318]], [[-0.515615969447179, -4.91971508627018], [0.0928706313375967, -5.10372105546725], [1.28624611210228, -11.2634891076897], [-1.10033219550414, -8.90528194074249], [1.16904410749463, 3.99741231102587], [0.684716597082611, -5.65136197122482], [-1.70574140891738, 2.34176271820893], [2.68843624550111, -3.51657060386147], [4.8068950253746, -1.46902835550802], [-9.37153696475802, -1.15131949846677], [1.64970327061807, -10.0456289170543], [1.66456935820479, 0.671643670234125], [1.41970465700127, 7.86400518645268], [1.31179747910153, -4.50895545996038], [-5.34475685312135, -1.10665926268044]], [[4.0010366123757, 3.49398228007608], [-1.81307647774142, -6.02687137600858], [2.02177246274534, -4.51445369262563], [-2.50377635575571, 6.36203536703332], [3.67396099620743, 0.366265113032038], [-0.46576304725214, 7.24184127712447], [-1.2278182926588, 6.11523907926796], [-5.91364720614965, 2.03871491158744], [-3.970252955547, -1.18503989214526], [4.37368625274087, 4.84795304323477], [-2.63726006483569, -5.13324492167145], [0.740120558288642, 5.87675809414439], [1.82172210847602, 3.55488888423154], [4.17111279190831, -3.86020598473393], [5.82570535648184, -0.939535615108174]], [[8.11557542326828, -3.3690742304648], [-13.9970372891203, -4.67918861303345], [-0.635948623720554, -11.2618274816139], [0.00019360950340994, 2.81816456070723], [-0.920892925558566, 5.87766017283643], [-16.1304950949398, 1.58706061779378], [-16.0579883004018, 7.88799900016855], [0.134282459782806, 2.5351044396219], [0.480345030837731, 4.71247100141133], [-0.25277024772606, 4.81384486337422], [0.117789379316973, 1.2636772563015], [-26.1334452082204, 6.56476041830415], [-0.24058185015999, 9.98150950680237], [4.50401756165326, 63.5598973226494], [-1.5266410500781, 11.6521931982746]], [[4.4954770279055, -2.42700143961229], [-0.950718917880874, -6.69567729661821], [-4.28647813506904, -9.60451388785012], [1.51798604178928, -2.10107311618831], [0.823246096494109, 1.42147310844463], [-11.9806334786568, -6.27877323097243], [-13.5078105331215, 14.4553610304029], [2.17978287005283, 1.83072984177355], [-14.6490456336714, 17.3474131454465], [1.89122599749223, 2.53065593741009], [-1.39363611664444, -0.365744223765225], [16.0644319547211, -6.99738464264358], [-7.70737784447037, -7.01410307674743], [-0.738274032275695, 13.9357986553846], [-0.176779392301477, -9.44158130580231]], [[2.44501986103978, 3.8089731049737], [3.22704577731422, 3.55215402534798], [5.03276659513902, -1.80088784262066], [-2.78479713918792, 7.28568203248126], [-0.670579673042813, -2.38122946044334], [-2.40039143617565, 1.87880367319349], [0.650165496709063, 0.873712144951067], [1.2200953400797, -1.1704806434105], [-4.55013788557117, -1.75253260608943], [-8.67396447251553, 0.246838104265888], [3.70455629861675, -8.26151619592469], [-2.78988317631851, 5.3226462189442], [3.20683015120818, -4.09828517979151], [-3.34513246509326, 3.52524725912751], [-1.42482161782169, 5.98575134066097]], [[-4.33193124290955, -1.81928354867991], [-2.10075442756988, -8.24804958111899], [1.71708304445412, 5.09265085546775], [-5.64120053403143, 4.01793653651263], [3.43258761230174, -5.45197965628494], [-7.75117635016496, 1.10598103268029], [0.891199241038495, -4.66168023646619], [3.1945000410775, -6.28979959473791], [2.10461397933512, 3.4494845842639], [-0.269733888879475, 2.82566784595564], [-0.0500750411829943, 4.53626178015942], [-7.78956050915683, -8.53323796760751], [-1.45551764764549, -8.29245516683315], [-8.02349022829521, -2.99998619543062], [-6.59034250175174, 3.94426063255849]], [[4.57723518302483, -2.4920079131024], [1.13386805578095, 5.50498535361591], [-4.6053835843453, 0.628240086594441], [-4.00228468828934, 3.41379561989117], [4.79777888246483, -4.52450367987978], [0.435308244155786, 6.58381837240448], [0.730900202626523, -2.92145000558792], [8.13457188879072, -1.98916804904881], [0.487255948596029, -5.31066667495709], [-3.26346377059309, -4.37853295690477], [2.22962165323571, 8.70809371510747], [-0.482991495382062, 8.20504740388541], [-0.874901131071459, -7.0453396708993], [4.76951099805376, -2.50361370236398], [3.46645237937129, 2.25109780304579]], [[-0.016502935897471, 8.57312408555566], [-2.2867637461674, 4.70160708072304], [-7.11251859611944, -6.29716954986802], [-3.30135921605622, -5.43704902022169], [-1.09197597239331, -1.73619611726749], [-9.697635060155, 2.3398983864904], [-4.80804399406786, 0.234546998920148], [0.512016031695225, 4.39610394626876], [1.18999783402862, 9.2125952490044], [1.98779635845331, -3.7334125430955], [-4.50461026352674, -0.202249795814677], [0.020453701759608, -11.5916042959991], [0.88287687842216, 6.86815192373453], [-7.85809903151626, 5.26269805378352], [0.594041226577108, 8.43758545295976]], [[-0.191325327334846, 2.57672617749339], [-4.4147957256601, -0.309794197062292], [-4.6460158608417, 4.6666544469348], [-1.84780787157693, 2.42256485627277], [-5.95996606416961, -6.31991819450957], [8.51548251457875, 0.762505547469681], [-4.30071831857699, -4.13782376027741], [0.836998890485343, 2.78445140516311], [-1.03178156579449, -6.64879719736913], [0.507048810749555, 10.9486883696007], [-0.907716174711088, -4.83124133255399], [6.60927349626304, -1.96911585342098], [-2.4271490188578, -4.66245073799091], [0.946476971195654, 8.23483222574065], [-1.7083064219623, -5.4107263584553]], [[-7.11989067482643, -1.76149372521248], [0.835687539864696, 6.43689317744557], [-3.43410536853213, 3.9242571128102], [-2.54022953572117, 0.787116271761293], [-0.939517972245156, -8.66902094878475], [6.89463171294181, 5.97109067034258], [5.27461860573387, -5.30224891588574], [-3.39332204671207, 6.10213007982236], [2.67701716294956, -0.945789174331009], [-0.437138376157371, 3.01633947279973], [6.11372973923987, -3.7538210497484], [-2.48807470682064, 0.576872702667259], [3.80425343300839, 6.81404581625285], [-3.05205837397293, 1.52938566522877], [-8.6257605651361, 0.654546505133285]], [[4.10164850069486, -4.30599475930258], [-3.48978630071884, 2.32257787374487], [-3.63867265314516, -2.13178301735223], [-4.74836580748156, -2.51863127195005], [-3.72696182200452, -4.06369533750626], [-7.72051140943731, -1.70362218117076], [-4.19017993349989, 4.33948190388683], [1.00886942014211, -8.82058851957875], [1.60993751649816, -8.02544297880565], [2.63839966890153, 5.15196306138577], [-6.1089095076561, 1.56346804187584], [-2.03793423784169, -3.99493414868661], [3.37947789481413, -0.95998019186085], [-5.52954245211969, 1.27853176234505], [0.683310502411715, 7.84432700963629]], [[5.17405903827434, 6.32620045031189], [10.054742703702, -8.93963424053582], [-24.9068813176352, -18.2198201076024], [-16.4206675736509, 12.6921625302502], [13.2637206833549, 14.290793060687], [0.642513002626429, -13.9084005494259], [-14.3831145711283, 12.2302367660909], [-3.21811307172626, 1.34961870753214], [0.741516630885461, -0.39768643233217], [-4.42861215768701, -11.3555938553757], [-0.973527768728407, 1.61061218588193], [200.051727330056, -114.817508009051], [5.46322026026871, 5.47071990047964], [22.9001952712397, -9.01610991233962], [-7.28265878675183, 4.00550846053278]], [[-0.0906321367911995, -4.51683492937253], [4.9718357053637, -1.78538404309692], [5.90093317595588, -1.48811207146748], [-3.18433288499, 4.80619904244176], [1.73167436435961, -2.5589042078417], [9.04659594206053, -3.21215277492482], [2.05091635958428, 6.91013349645154], [4.71605856210763, 2.03835820857358], [5.73530903916325, 1.6160391719277], [-2.75942214875748, 4.9393999533402], [-0.738311764757295, -2.12870497228953], [1.4048662924737, 3.94268261318527], [-3.52052791300009, -0.0692966326015779], [-0.986213132545903, 5.98807726434543], [2.38901309085107, -4.6739225925418]], [[4.19642745801002, -3.4224480655276], [-4.09435020178681, 3.98082892178272], [0.673401786404081, -9.30117407017099], [-2.81474323201242, -0.716798146219082], [6.07034981414789, -2.11532278379506], [1.46255723297864, 13.6527931956977], [-8.02496408299183, 5.13412888402883], [-8.34037484658884, -4.04696601856113], [2.83850497563651, -2.30167051930161], [-6.46931346245891, 0.887219890950427], [0.797902448796861, 7.21254107222914], [3.02374804420364, -3.65953223063417], [-1.14055444771938, -9.36969626194119], [-0.520720617494402, 5.95880353385796], [-2.49414902487646, -3.97117644174406]], [[0.995141499172879, -2.98069788193602], [-5.78204270620005, -2.21556200906432], [0.91176927353634, 5.49833788732538], [1.9643845195051, 3.2122718635762], [0.780847677456203, 7.45672640819379], [4.83863725151097, 0.11494238237695], [-1.03657244123424, -1.64344872581593], [0.065466070541305, 5.50617660661505], [-0.0588556470342717, -3.14574824078656], [-0.636002562755176, -3.22761000412368], [3.64927623802071, 7.46411647169969], [4.22653708478001, 12.1922852931992], [-0.746466739678684, 7.6550578459116], [6.44012675464896, -4.39490837404709], [3.1258355199941, 9.71553065848421]], [[0.419594307336383, 6.04202919240648], [1.25517095989893, 0.601431690031396], [0.218728144059845, 9.47982948717443], [-1.06101420579843, -5.30174088990322], [4.1079649265594, -0.645008181956223], [-2.014184030029, 3.05913626709991], [-0.405807917593045, -2.76138915293758], [-0.569303121149974, -6.05073846430055], [-3.05352787392197, 4.81935057022378], [-2.30368729789727, -0.206336110619548], [4.86046117566924, 3.52393754763858], [-1.04604952593998, 4.38195189661306], [0.977528982120841, 8.19533138744645], [3.01747886283892, -4.43319724953707], [2.1979446740574, -5.26435795167874]], [[3.99072945214989, -3.39561202076896], [5.7879711641182, -2.42713204443233], [7.98405933382027, -4.58203774318156], [-4.90638525214472, 6.36314727571165], [-12.0312733539776, 3.72579746409717], [0.871049276966268, 7.34684069321076], [2.05957656908199, 3.86475879005074], [-1.15619065111992, -8.78811374041657], [-0.768626610994531, 19.0394947961706], [0.427435171664245, -15.0972387236982], [3.27015922927663, -1.05694994722532], [0.900277559310207, -1.11817131677545], [1.17661817830638, 9.98287834990668], [1.12245638302279, 3.52267171993303], [-0.673891570699711, -8.09891242947339]], [[-3.21901488761844, 3.9592545069155], [-1.83913975476608, 3.33458887702696], [0.699816151029038, 12.3207341074243], [-3.26818893781441, -1.05891431303751], [2.13574646811498, -6.8929371020515], [-8.04522937835488, 7.50284651380094], [-3.54162353123964, -1.05095177747388], [1.16811662175724, -12.2465783321543], [-1.55841082777493, 3.25635439390854], [-1.40147703112421, 5.44494717731099], [1.343998971629, -4.28989355303511], [-1.55236739821233, 0.0415592971644179], [0.970516964440305, 7.04787715264861], [0.890839554149223, -4.51526611812676], [-7.06198870395495, 7.06150685893271]], [[10.8807978404229, -0.745199379492441], [-7.44537473847936, 6.8544316940817], [2.051525160191, 16.849274521566], [9.80281969680401, 4.30174103158341], [-7.65701823767079, -1.10313197271011], [8.79115463874699, -0.887673663927242], [-1.12503767073448, 1.17325036916732], [0.045463046850013, -15.0018582042756], [-5.99752080198759, 8.25065347785066], [-13.8780225832648, 1.17095574518868], [4.67199438836039, -4.71777896014617], [10.1422170753523, 17.1427656571051], [-6.87207467770151, -3.80384858065098], [-6.56277981134903, -0.857200004643934], [3.44187998676479, 10.8895491160446]], [[-9.1630971797653, 2.46644615682967], [-4.29723930410533, 2.8631441092125], [-3.70703333719642, -5.13819042267182], [2.26540168718004, -2.03195265879599], [-1.54826818363741, -2.91499593442053], [3.26547914240126, -4.62390481733972], [-5.95926281992641, 1.46381375020628], [-2.80878617011031, 0.268437703913337], [4.15398404898958, -3.2913253104492], [-3.57439312547863, -1.3969454298372], [-5.67523798020291, 1.24000838199201], [-3.42791142643515, 2.01852999106775], [-0.0989670440006946, 5.91212459038658], [2.79833890663726, 7.42344550997127], [-3.96681376683004, 1.61351197344486]], [[0.0415360056766102, -5.36408840440677], [3.58078502940398, -4.28526886228261], [-5.8005972945185, -0.360281494375585], [8.34227863787916, 2.29865228097735], [1.48289280443868, 5.40953175165631], [-0.716644006898182, -6.05204674247913], [-1.39503206300039, 7.08292293376633], [-5.30690026834004, 0.622145565366195], [-2.02957343958607, -2.55676979644569], [7.74876348856805, -0.445655195564208], [5.07355015367811, 5.37416444755185], [-5.78459727631832, -4.40919059402408], [-2.13291851160771, -3.89170110242218], [-4.91116506232774, -3.55892907353498], [-0.973335526110557, -4.6950438204303]], [[-5.02496839546822, 2.28677652647651], [-7.21497497186552, -0.427603994199369], [-2.63074870477766, 2.99766315821171], [1.11587347243667, 0.22982527975889], [1.45255699194804, 7.16094998706544], [4.56426573982409, 0.828660943845888], [-4.91924526332423, -10.0632750772122], [4.43076206866409, 0.0928969785043968], [2.35523162549524, 7.99459555815125], [-1.07518717521998, 1.4251982397682], [-1.09249418407206, -2.74626252116885], [-3.23195909118067, -1.95222438335456], [-0.263938941828677, 5.17010485819421], [-1.03225764767737, -5.48504523733755], [-1.44554250069386, -6.99981056155377]], [[-0.37131499665696, -8.28337089053036], [-3.03349423176859, 4.50143357127052], [2.40465536111414, 2.65166602072098], [0.851376374827651, 0.973486802082395], [-0.0146068784959951, -1.79360680637732], [5.17620857393557, -1.79258551422127], [0.596317175339736, 5.68673078419241], [-0.271252721016033, 7.32728341873475], [-0.6808628743874, 5.89967408590254], [-9.38027454164044, -3.4036477377162], [-0.344382407857561, 3.3280324861601], [0.627857072820525, 10.3467199932142], [-0.944062610864202, -12.7460655947258], [1.71393603203394, -2.35227465200056], [10.8052507875417, -14.8051232583985]], [[-4.36548818499233, 2.86018814321276], [0.802396263427972, -4.27642801326504], [-4.33680546830714, 3.02797059363241], [-5.00212373252489, -2.36178977117091], [-1.3883044439435, 3.63437861954391], [3.70505630384336, -3.51398375028983], [-1.78187550506395, 2.02739333807746], [0.0392571974890757, -11.1626909824657], [-4.89753077884675, -0.470277095884735], [-3.9307700930221, -6.09135503852938], [-0.995414510412513, -6.38655609351536], [1.17974548368095, -3.21347440848617], [-1.33788493972755, -8.40404598969064], [-0.317867169646316, 5.06029267461617], [-0.264103741850978, -7.14586460057651]], [[-5.60397485264853, -2.6942575452523], [0.646072874352751, 3.60968723106002], [2.11324152410883, 6.33052771385365], [5.96208052659781, 1.59931062653295], [-4.73952971717546, -0.604810912061056], [3.4853118745486, -0.640419089962054], [-0.0731761245516349, 6.90367332918177], [-5.58830921669593, 6.32421698066828], [-0.750151651347271, 0.551320033282566], [-10.8660066031569, 5.17539331532555], [-6.92791781753523, 4.41642313654906], [-4.26203752459182, 1.91960494383346], [-4.14533900822424, -6.50037718131178], [6.94068614552965, -1.73536541058313], [-0.733997616864671, -5.83193076536153]], [[3.97477803831005, -3.46703474298577], [6.47584367928656, -6.86760806450773], [-2.50535352364471, 2.84311756960985], [8.90265709269624, -4.19114862518332], [3.14506099731863, -4.44437346746606], [1.81310906801674, 3.94057136922505], [10.1548369243418, -3.85368264317796], [-2.22633190851241, 0.0799175610897428], [-1.53437643130168, 0.552941777559038], [-17.2637668348738, 12.6846218489438], [6.11926748816912, -4.45771179931971], [-1.4487074132818, 1.98528504282056], [-7.64836150316427, 4.05316091198457], [6.67419911848711, -0.819641456816118], [-5.00175499359616, 3.71859197340369]], [[3.28532610022074, -4.65859106103668], [-5.81029249309462, 1.19543357010198], [5.0112161779767, -3.35123293965042], [4.75698500937942, -1.31550162248456], [-0.903712900211402, -8.83101480677855], [0.41683905329028, -3.95038088567858], [10.851992680124, 3.51410833690167], [-0.175661736874749, -4.71359464205482], [11.5579755623555, 0.253455843248789], [0.0533380698749607, 5.26501092850921], [-0.0340272560079482, -2.15167963205398], [3.04631037849313, -2.28731271899881], [-0.494307979600839, -11.3730224791445], [7.04552243726191, 10.5272806589663], [4.04595202902751, -0.539180123159003]], [[4.11930682832859, -3.44085558355071], [3.33555162997972, 3.77425165633862], [6.45391665141161, 2.44466079063875], [-2.42204841442012, -5.34463060996994], [-6.4924507218689, -2.01780741463713], [1.48185107352025, 6.0770515525246], [-0.175562619457624, -9.13186257876967], [-0.117887016508797, -5.53632879140623], [0.0278995672819984, -3.70820454953912], [-1.37164774597976, -6.65010418545519], [4.12857930385955, -3.67543803421638], [-1.67190974770819, 4.43056420323589], [-6.49629333573653, 1.06391463327113], [5.17113733195249, -2.42824096265346], [-0.680935341626644, -8.04310490727211]], [[1.01547395199192, 5.14473513408261], [-5.82365331791246, 6.02151598364893], [-0.0596316048101966, -6.63840995102853], [6.14520217692757, -1.77759160907541], [4.33366577091836, 4.82461542737622], [-4.42183729442026, 2.93857679299932], [3.78742028382435, 4.448203666121], [-2.68550550983268, 7.42213403794134], [1.36332467167781, 1.51516069082659], [5.44672756092847, -0.394710886614144], [0.731233664343788, 8.17719606343898], [6.101028562785, -3.20718739993059], [-1.39043748132486, 3.2300930443042], [5.70179082314703, -6.64952367842032], [1.66365876319422, 6.22041259389043]], [[0.814589128634192, 10.8120528219974], [-1.7442822848284, -4.37639461480913], [7.16107597086285, -0.815268695449732], [0.901005569429779, 8.34481460442726], [0.546152928395695, 10.1449458053999], [3.94756903568368, 4.35974345107182], [0.135520256590936, 4.68700820818909], [-0.562118022117686, -1.99284883848637], [-1.45066614623582, -4.71492289133883], [-0.425969546903877, -0.98074949157535], [1.90556345314497, -8.29609979279925], [5.09519039145706, -2.5977569661898], [-8.1161782860893, 2.00460323958105], [8.32577047160593, -3.5190160909197], [-3.96504395662525, 1.56495926873821]], [[0.149851677594081, 4.58705586485227], [-4.07981303143201, -4.6139115116512], [9.63750354346851, 2.08052388250995], [-0.335441880855272, -8.75010587120176], [-0.0236584873670853, 1.29480979170953], [-0.0731167930507035, 3.52179392174445], [-3.80444122522192, 1.08179607317279], [-6.64198752625927, 3.38053888538107], [-1.30698212972208, -8.08038098176769], [0.311002598631304, 5.95676417949494], [10.4513263798427, -0.122011349561052], [-10.909975438765, -14.2695043117429], [-5.27097905172823, -4.98047145234785], [5.88353196229581, 12.0960619475061], [-0.352108477929579, 0.449411325556956]], [[0.526899059000584, -10.161880691436], [3.58905508675811, -2.42104678425198], [0.0310455636361734, 3.72331672799996], [6.34122223557112, -1.78080710996974], [-2.98249992241444, -2.25842108637112], [3.94902195785799, 1.39414729843668], [-0.208400846206236, -1.35156753826361], [5.94821737927957, -4.28220728334672], [1.97268314735443, 8.20713900311134], [1.08030373644077, 6.1255588611424], [-3.19981186760771, 2.1684193085095], [4.45258826689023, -5.69754271980766], [3.50136962864398, -5.07583867896368], [3.47843196401072, -0.918037006014369], [-0.078763142565633, -5.59472347025998]], [[5.60214346244012, -0.331084853066907], [2.34282577459414, -2.96311999522919], [7.44970500729094, 1.91275087883998], [-0.690663815104792, -2.05638872135556], [8.83185712922257, 4.01514979365333], [-5.61607227001728, -0.471280371532055], [-6.76266020301444, -3.54884802727426], [-2.50140282779733, -3.99370077199238], [-0.327996531480701, 3.18251190952969], [4.17019546115704, 4.45099137824412], [8.6158388243054, 1.59549897132572], [6.97575095362403, 0.19960677838083], [4.95821321326854, 8.72561451438343], [-0.453750288215581, 9.23739066135596], [6.6658582956308, 3.60623984725504]], [[-4.34548177925344, 6.83070907829712], [4.01346437476148, -2.88600218503332], [1.4629037463107, -5.51912458774845], [-2.37553990971096, 5.05404203601534], [-0.304337637790761, 1.31319532383843], [-4.05087743571974, -2.15629195732142], [2.75600720373229, -4.14314170897554], [1.45625616351039, 8.21161447627648], [-5.0337414613078, 7.54406045516861], [-0.0199113022028384, 7.00487992008979], [-0.636280877620584, 8.2047117942568], [12.2589059773236, 2.08149873368088], [7.31174473674086, 1.85133743841955], [-3.54557059151298, -8.18909466466565], [0.548322622804425, 9.98782533950591]], [[1.99491685007495, -0.684634318685941], [-9.94462915320585, 4.93738857428236], [-8.36533933499691, 3.15842725773594], [0.88658469954214, 6.26938951634387], [5.72345443930089, -2.07413977995298], [0.174628004320814, -10.0658403372257], [-4.91517738628448, 4.47978621113926], [-5.15894148652298, -1.51992767956618], [-3.9382480028611, 3.27284336119386], [-7.44231544007402, 5.88130071536048], [1.6841012355034, 4.65135849684865], [0.705239424629945, -5.8821467465597], [7.22713814096791, 3.17112866158733], [-0.514728362036895, -4.23779030070159], [-6.35351621687678, 4.09791488971885]]]
    P_means_w1 = [[0.372399011003459, -0.380841226051439, -0.169850610018946, -0.265885822824427, 1.54512585461185, -0.138328266500502, -0.176508994003896, 0.99666415591375, 0.887447781403253, 0.537763639966063, 1.53576107805992, 0.429656028387789, 1.42016333994945, -0.148369252450953, 0.0747422767429948], [0.0899987863366545, -4.96688456690558, 0.165959548795151, 0.119159550286127, -0.367034259001791, -0.00379429302590138, 0.061481421436449, 0.289858655948572, 15.54605541121, -0.512831490231362, -0.488441069113088, -0.1100705044707, -1.27050072691788, 1.68463131954124, 0.0350535741278387], [0.319596180509784, -1.19969512274467, -0.357230582915514, 0.573390185521219, 0.0070374115447117, 0.294243573595832, 0.458150847486479, 0.223519591908857, 1.95764991334982, 0.0480167208008535, 0.797895167924651, -0.0816661595155315, 2.49433424591584, 0.350198064835573, 0.873193518174541], [1.18894375095808, 0.309853680599488, -3.59228533167858, 1.4074050284276, -0.949803893977592, 0.512845959580715, 0.404906863907885, 0.665349273112809, 0.189251027274752, 3.27588680012008, 6.98903307479288, -3.08693682486352, -1.14171394240988, -3.508313908376, -1.74370859780189], [-0.241653609512473, -1.90598332493372, -0.10065462694331, 1.24573354020626, 1.73897090674692, -2.54047146153152, -0.855226751269759, -3.79614802352416, 0.891821521599805, 0.301171678871424, 0.422672469079897, 1.3773494806797, 3.67907207271276, -5.49959617446436, 0.913035030088412], [-0.454026987717232, -0.36320562530731, 0.53955571057799, -1.24565195459237, 1.95702653750954, 0.0776589909232074, 0.115687111976263, -0.574014986614158, 0.0553943644193673, 0.591951445210806, 0.669553454049678, -0.701469171337394, 0.347654022470878, -1.83036802849087, -0.433266238564541], [2.41523907054469, -1.91677012333824, 0.0727120687889306, 0.121397203651391, 4.82114495951487, 0.0489437742596467, -0.353905935569852, -6.0763250029444, -0.0574334421527685, -0.0945474192389428, -0.0717843030391363, -3.26712438360733, 0.0296625592096907, 1.10259355754216, 1.23369189861331], [-0.129202318776089, 2.11102497858521, -0.366768004616333, 0.154353951668635, -0.587899921843032, 1.91783758511778, -0.332142921839442, 0.122290335792657, -0.446663550613942, 0.637224332437969, -1.71651122931921, -0.0582041724797076, -1.89577353675094, -5.66868717359687, 0.183778282164013], [0.635064136591356, 0.158983191144235, 0.105038533850086, 0.0671940567312789, -0.0729640101772079, 0.0923744991366292, -0.332170964478659, 0.0232335056788856, -0.11107690853884, 0.0166653425401887, -0.0889336186371005, -0.137638352802003, 0.0157455950454832, -0.325892285101415, 1.26527522045414], [1.97727551490491, -1.57437126219254, -3.25064828983346, 0.451684671022357, -0.017415117777218, 1.82973718665417, -0.318302051597342, -0.0376585886804729, 2.22372261911349, 0.184382374832329, 0.0930210730320747, 2.60646570464886, -0.0068576700502573, -0.0345101713501836, -0.0284993036077735], [1.33096185146644, -0.351084319370233, -1.21592699695563, 0.37304406571596, -0.938858597760862, 1.50868172706347, -0.174767496463403, -0.0473990492693269, 0.00587134107852824, -0.34804320656146, 0.683023951745364, -0.724043883565716, 0.267867590885826, -0.360731413756974, -0.458044422311387], [0.0838551618720492, -0.265483773190274, -2.53624761683692, 1.23062686424446, 0.0484109616829271, -0.0788928113572297, -1.05316240819624, -0.418497059789333, -0.998677149158348, -0.133282326099208, 1.13915619334696, 4.86367439161035, 1.86578748029696, 2.69657521639349, -0.383873144424015], [-0.245236752284284, -3.35075588957737, -1.237757610567, -0.0629403452970223, -0.491185846518303, 1.79943698929221, -0.281335920381472, -0.441989171140918, 0.533817000436523, 0.0778458588765263, 0.855145631340109, 4.44267066070906, -1.79396520112178, -2.59412351382067, 0.903766678729322], [-0.0243489495170063, -0.827922569538629, 0.597918144192441, 0.89867252594807, 1.74524649087031, 0.350971773379211, -0.579112676576417, 0.582233861166562, -1.095391303819, 0.667196429462937, -1.54693227271139, -0.246463966874418, 0.0913692293752672, -0.0722784909134155, 2.08763398623111], [-1.20712913572845, 1.68063673808871, 1.80999522090668, 0.0885716968797607, 1.82978120664791, 0.871690106763132, -0.819725932693016, -0.381541196796567, -1.42986766049908, 2.80965176125491, -1.29777781664899, -2.38774865107147, -2.31362850051405, -1.34314258305175, 1.07350670326333], [0.160849745322597, -4.46848685037515, 0.0855164044703447, 0.334907942345396, -0.171303793404876, -4.50133509114861, -0.0460024350926886, -3.70130647505298, -15.3642072503802, 3.7914914191356, -7.10335830122294, 4.46674333460994, -8.50209382933885, 0.734005959801731, 7.32149516675953], [-0.117061898017075, -0.143111831679293, -0.969972236709818, 0.800401159652164, 0.0551967481640128, 0.549044389215383, -0.144889527201125, 0.25636336985559, -0.621223596831485, 0.0740534775710212, -0.141723426646993, -0.126534756814985, -0.264869338503351, 0.92430335772275, -1.17958588683235], [0.053644913480171, 1.41557880339133, -0.725957072431802, -0.0736612204327489, 1.01297553868208, -0.405500937478471, -1.28250017793961, 0.165984516128524, 2.80490336261883, 3.10706250784185, 1.43101491204931, -0.0116180224211951, 0.226747977400081, -0.0975884865915458, -0.0801303321565709], [1.2413978412077, 4.48697188334875, 1.8081570247427, -1.8266330594158, 0.645410097609992, -0.107905730139614, -1.90288340554068, 0.431930962958151, 0.10125853265663, -0.0345854455786395, -1.64077299861336, 0.253439203708317, -1.46770034270624, -2.9195114279883, 0.178831555698879], [-0.629987302423367, -1.75602968539445, 1.20080176316926, 0.67540160808031, 0.327569269347936, 0.874264072395367, -0.619083485883262, 0.0262310950477519, -0.260028153713149, -0.12229619943264, 1.40750732593112, -2.52022822035358, 1.89695545361981, -0.131259389885003, -0.141203541041912], [-0.224709045079778, 0.158323158738668, 10.6856752522459, -2.24550700073842, -3.81213556328891, 0.0467527281207697, -0.113719125560875, -22.5355429040269, -1.99946211008555, 11.0050420203231, 23.9131345558738, 0.046419549601966, -0.653928919489517, 0.149023614377928, -6.39018586503563], [1.78313670360025, -0.188851577709581, -0.115666085010877, 0.449206280194443, 2.20815905203194, 0.0366014407429679, -0.00775426435451113, -0.235143366836064, 0.0278678799090425, -1.01685105032241, -1.23201311037359, 0.00821459587432805, 0.0788988795917251, -0.119244507456444, 1.13819615229612], [0.550423339439544, -0.149624870201445, 2.15012115219756, 0.596703864961283, -1.41227897124244, -0.462155347921081, -1.5820202071701, -0.033980437625904, 0.0335855255532728, -0.0787239485948596, -0.0424438914953706, -0.609930916949423, -0.777502118635219, -0.492430827006613, -1.53490077602201], [1.41496300889613, -2.16413387175545, 0.588465531901926, 0.0886553412630957, 1.30735995094362, 0.0735868345339337, -2.89969835790386, 0.404448973696758, 0.39321419479999, -5.21470883262252, 2.34402395093326, -1.98479524586514, 2.48736780760902, 1.93355643724388, -0.174517089426469], [1.37148618146506, 2.0460403945773, 0.593732103056974, 0.531323780110067, 0.38340564631156, 1.43680206504634, 1.22979535045897, 0.0424205516308033, -0.873457694482035, 0.462556051522105, -1.06545541900085, 0.56890013925607, 2.66586431662583, 0.443404014934943, 0.398048735503651], [-4.95774307825982, -3.45760040100445, 0.217556923226083, -1.11129632114282, 3.66912178175521, -0.100496017808541, -0.427680311901572, 0.77378958752863, -2.27323928110252, 0.623623496523751, -0.25510170774541, -0.393395207006235, 1.53323691868023, 0.312439356534637, 2.62007967855268], [-3.22268953201907, -0.304698352055477, -1.23442099682305, -0.347312212861092, 0.42910867322719, -0.111971424455236, -0.54869838206848, 1.53612868676373, 0.65698600190993, 0.23031738913046, 2.13043194353541, -0.0799900438794828, -0.481627808825365, 2.02367660230446, 0.195676709518402], [0.273576847700446, 0.407048733605289, -2.58810686610757, -0.651804905930802, -0.573381515935664, 0.0593281030270886, 0.22344077252483, 0.399443449093355, 0.94104380819392, -4.77039751566523, -0.399886595232699, 0.980777705999675, 0.499354136042198, 0.0151630274407032, 0.268695135095675], [2.27279336276946, 1.29746154641556, -0.531891714014034, 0.463894097717825, -0.469886811632467, -0.20823590906475, -0.258718301102346, -1.38494095892501, 1.19188769470814, -1.68971025249159, 0.488720136696635, -2.21909797021801, 1.66844786030372, 0.899915414439783, -1.85356205298487], [-0.138591207333001, -0.355009300014976, 0.0480736592206581, 0.0583606670295673, -0.0354687643174645, -0.242324271560956, 0.0297414705319449, -0.304707335420338, 3.09799325530105, 0.274318559743734, 0.831466653777506, 0.00261203650921754, -0.117190491804334, 0.0370861261092868, 0.125676227812916], [0.597306690664033, 0.639476181299512, -0.790399557164829, 0.424595271614824, 1.02458638075783, 0.0288164218658192, 1.42404367689138, 0.625129214960775, -0.394651011094807, -0.134219214780409, -3.58819419032232, -4.17153561929449, 0.192068222480193, -2.17442070932253, -0.970737141114007], [1.33434091274466, -0.464120341376713, -0.121199193275614, -0.189543987016976, -0.393295086105459, -0.128959918776802, 0.145089049558579, 0.063340630605154, 0.867966985004465, -0.130340407083242, 0.437391111930782, -0.584795959742759, -0.706276724689891, -2.40188690923143, 0.551409819697807], [1.25670682829546, -0.0577084290879527, -2.69801187742266, 1.30797361546131, -1.96289421011109, 0.015171803030064, -2.27102121748943, 3.00657235354194, -4.21940155991808, 4.03700726617845, -2.65606991128009, -2.06945377324828, -1.01552919733932, 0.23550810193533, 4.95138513798385], [-1.2000166783756, 0.991930326943791, -0.340287954222558, 0.979182386838257, -0.128168961392253, -0.213785963151871, -0.838867931337872, 0.504657053541422, 0.0345830270386675, -0.313394291382138, -0.00436061223986048, 0.334917752016808, 0.995568936665352, -1.01122329428778, 1.71264399800125], [2.13692082058294, 1.25589281700955, -1.61121640563621, -0.120062690734999, -0.0420261123000976, 3.17407151856313, 0.938400717103668, 1.519526258144, 0.232401645179308, -0.0595797357049891, 0.172911966591827, 3.58840296656951, -2.10520844249652, -2.38535637226505, -1.8010694203978], [-1.11505326540256, -1.48182037394272, 0.47229419532828, -2.21179069655497, -2.69985278848124, 0.0535397667714984, 2.1544166360612, -0.483747202963702, 3.22075308622899, 5.16588843086155, 8.45983934242155, -0.578081467006761, -0.36596196766969, 9.3874045885187, 3.02804288223334], [-0.0781378445437492, -0.0305601184999616, -0.416768184063611, 0.332563592098806, 1.1414794785342, -0.0962456449444815, -1.79949105559141, -0.322866254910188, -1.27784103347961, -0.0452657018056698, 0.206378730607966, 0.137662265473036, 0.470518255051657, -1.48334773293057, 0.177677667077459], [-0.129056402974527, -0.22863513500746, 0.155171780371314, 0.728139515145053, -0.852496517631991, 0.074641170598444, -0.331031582613605, 1.05041122014858, 0.128029324701803, 0.345094664975519, -0.57350664000969, -0.718726622074344, -2.13867857683134, 0.381287275868652, 1.44881386945471], [1.70948366375691, 1.78805423416601, -0.14529003353914, 0.0637974622937011, 0.676689187686625, -0.599516519299206, -0.215640756987763, -0.10268051865594, -1.09974589198613, 0.0336903815673206, -0.908147331904446, 0.103040217890273, 1.30621860614022, -0.738370273987544, 0.283953824317413], [1.15748862555589, -0.138176799349284, -2.68780768106229, -0.404123062448773, 0.406661657456011, 0.205402853767024, 0.00871912834479191, 0.104330971634358, 0.397483678973312, -1.19961547976191, 1.58636574622616, -0.37522416154251, -1.47576853560026, -1.70983667535413, 0.590345140807983], [-2.01782658804932, -0.144754422967409, 0.45022561422291, 2.65901897341523, -4.5581707918178, 0.0451120949981467, -1.38606236211541, -2.48944742355937, 1.33389755582873, 0.0184378513939337, -3.53986468415705, -1.5087268756891, 0.497161630639128, -2.03298034523778, 0.00631810732375796], [-0.483845098996463, 1.08886040280643, 0.0111379857114012, -0.0519311650856554, 0.100502104516558, 0.0104930801191925, -0.351538836769423, -0.32262932881889, -0.0811205550815787, 0.422601273922355, -2.46431006779759, 0.82666324595774, 1.71305583395233, 1.28421708885435, 1.27408555038881], [0.122683241198832, 1.16279911592364, -0.537504250315819, 0.196400138069008, -0.237353116606913, -0.430400613935497, 0.445029649948052, 0.129078563853177, -2.32600549526883, -0.0130773089793033, -0.0267564216915409, -0.554183959530969, -0.348923798872751, -0.200143446108171, 2.69418226062285], [1.84494783123169, -1.35597238063863, 0.3234811028748, -1.80065557032287, 0.412557274496742, 0.495860957603667, 0.0749847267417007, -1.06519836516255, 1.68219529375254, 0.0504800826036807, -0.0571351101323491, -1.43180337244869, 0.158242406475216, 0.310023684409426, 0.674577703539426], [1.86037151487159, 2.04141120320303, 2.62719262108374, 0.0187040996655547, -0.492464095459396, 4.8308141110178, 0.0208609581058438, -2.3455160887463, 0.0301643578679136, 0.851892281539336, 3.96623606955291, -0.992050084699185, -0.383248407383156, 0.108624104014539, 0.247118745010555], [0.433615243449125, 0.192126843513096, 0.862972654408191, -0.614993696648274, 0.905373798921515, -0.641952455180553, -0.540253094469108, -1.18868457061475, 1.61259114699609, -0.513217406383316, 0.0680517551907535, -1.14272728881705, -0.0796731543334723, 0.0609841733355026, 2.16115650979486], [-1.56250473088646, -0.194892410474993, -0.980284892874791, 0.0515158569322999, 0.118574991534749, -0.0801872213742801, 0.538622885050829, 0.25152557650004, -1.98085785353556, 0.280016173211874, 1.27000250826822, 0.447877308584609, -0.579689737512858, 0.167806116441927, 0.832357525180536], [-1.40377321855383, 0.392884301551263, 0.011637015924242, 1.71903439444597, 0.503606666721959, -0.131160223336426, -1.39690533371169, 4.07858552461793, 0.734145819508058, -5.98003511725514, -0.187523803526708, 0.131922054233685, 0.0586422592903366, -0.00786820990285834, 1.20020701558529], [0.336842377234055, 1.2900644429671, 0.198877258333691, 0.925098816713211, -8.13340308100481, 4.66830830031924, -0.101974558700355, -0.0461935438238725, -0.351979608985714, 0.598030289999649, 0.101801080007468, -0.100566390254562, -2.36042538302201, 0.233259346029881, -4.79889344638416], [0.369585575105322, 0.477026772946599, -1.1702238596999, 0.0692338052861822, 0.826796721762833, -0.143981018341739, -3.24010213752326, 0.0925895763410543, 1.00699453604938, -0.650515184238689, -0.270468376105301, -0.0953485822335998, -0.128319707828166, 0.440720140075935, 1.48378572771127], [0.0250671035513026, 0.472297896354741, 0.0735812910872277, -0.80280605385929, 0.0410461454650797, 0.126608195607704, 0.127786806529974, -0.726645271025193, -0.144906249349739, -0.0363539283111663, 0.0473082672577844, -0.226371755293156, 0.267471202755877, -0.924338630120569, 0.306170698706899], [-2.66699562042236, 0.0431132478829544, -0.218866987882564, -0.188166964203149, -2.56817989368191, 0.0359424571917974, 0.0348131542348356, 0.225748793962814, 0.0334520860479361, 0.809863211157882, 0.416833272087284, 0.00274293791334046, -0.390279820957139, -0.760957506065617, 0.069914170317823], [1.58409168722825, -1.28184818277845, 2.17016152069473, -1.5362853932786, 1.44729379254167, -0.354126000897028, -0.186624820457447, 0.0202888996122738, -0.453435641700378, 0.175506583594804, -1.00166910147765, 2.0741943094536, 0.104473110474966, -2.83866285027449, 0.177261312527634]]
    P_means_offset0 = [[-5.43037187096061, 5.24469934356527, -4.79351105638582, -2.3167545994668, -1.39260549526088, -2.34861058384017, -1.49166733996819, -2.61583347432726, -2.69504822697065, 2.39763687811714, 1.7747682177267, -5.084944777136, 4.10087509632112, -6.14207747636996, -6.09120443112554], [21.0731445327814, -110.391941006121, 11.3474039382005, 10.7201458870767, 0.0754617991374123, -19.079895195342, -3.33898422897681, 1.01948976213204, -29.0063525630654, -2.06907959708398, -5.28288205486851, -41.3304487385099, -6.3441670297244, -1.85710032340024, -6.20494815866691], [-5.65939741028698, 6.61619131031513, -3.74789641750387, 3.04246358827419, 2.58971283941213, -1.44523056299932, -1.33001449059031, 1.30083022420594, -3.14967280893972, 0.428730359564142, -4.82970396388963, -2.91632181771447, 4.76476164873052, 4.79351622998669, 5.8788212627537], [2.95700507364105, 1.28937106856288, 4.08280987967581, -0.870035987869609, 4.16243195747123, -0.683785454372359, -1.21970162046699, 1.05491936556553, -3.60203826630998, -4.49852132158266, 4.57691136951464, 6.09892043342842, -6.90197173635667, -8.43911886321809, 6.31543700575049], [-3.40970643492284, -3.10595733632621, 5.34969516925162, 1.3986132550932, 1.84890181819453, 5.06111909569932, -0.0471451198773732, 1.23988710720393, -0.131324739051672, 1.0938447227874, -2.37854912259629, 1.5582023336507, 4.03702034675424, 3.30769955419776, 5.7304182959874], [7.61039323524509, 4.60875575007286, 4.95694928220533, -3.39502925087798, -1.96696728022732, 1.5117209400932, 2.57523558863617, 0.920482065117796, 1.19950980451443, -3.24791826865732, -2.57494695964491, 2.19739778601241, 2.62254961449135, -2.89131284097284, -6.58438593490769], [-6.05226098483283, -7.22304565934695, 7.89384989002299, 2.40469602329769, 7.29973655634487, -6.92621247989954, 3.70237959867934, 6.69072320921071, 1.24015237026946, 0.986765262520625, 8.09933055461269, -8.91564522783123, -2.35886585916549, 7.76972510127461, -0.165078695462177], [-7.50688562558121, -8.54295239877703, 5.17558366725485, -2.15645669455585, 6.38049754136585, -4.04652471072653, -1.42380167731015, 2.23751136479799, 3.85817055149693, -0.404295838033902, 3.18225194628469, -3.3897181331207, -2.72379019006464, -2.62751023062255, 9.43233413314181], [-5.91153543292786, 2.99135176956959, -3.74180265036839, -2.05577776077457, 2.51066197195255, -0.810351841074795, 1.59399375823841, 0.07131131901547, -0.792361715043874, -2.51942491809746, -3.27276825847682, 3.82677876262791, -3.56214621787318, -6.22184272773505, 6.0900901952153], [11.0906096814662, -2.20226661857288, 18.1814099556257, 3.12469087240364, -8.54893651648755, -2.15701355448016, 3.56914504157703, 6.20385345213187, -0.152093382553581, 1.11267106452203, 6.79188296154659, 0.0727793329856837, -15.6929410506089, -4.17858842084628, 6.96155479126951], [-6.05889072060608, 5.61501401876857, -2.49695498491398, 5.18153808625807, 2.71020665664071, -0.969133325307374, 1.30859585626885, 1.00474888994135, -0.104867690917063, 1.61444209342146, 1.09641508010066, -0.918223222675404, -1.63850478662392, 4.03364462375357, -4.93163092307963], [-5.44947384900355, 6.37343606376588, 4.92077845095241, -4.34627782406099, -2.77003449948118, 5.7255619881739, 3.03663267688487, 0.0789152699712411, -2.55389772541752, -0.171624234217838, 3.16958488502494, 5.81898943367049, 3.99428278484803, -3.56111347286693, 6.95438678661758], [3.6163344574544, 4.04205228614546, 3.8476235550616, 1.92602679838335, 0.65161703394208, 7.04760504011986, 4.83457354316596, 6.57973391248056, 4.87731785997322, 2.92767692915072, -4.3253241580921, 2.21621957059086, -5.71256110280641, 4.75114454758557, 8.9614610268436], [0.97542673717009, 3.41930261798304, -0.237453927866745, 2.78047519429568, 3.93290469252366, 1.18086820752529, 0.827021509946228, 0.374414492922928, 0.951699725719765, 1.30087485514049, 3.68430503601277, 1.07013138844394, -6.37004106787631, -6.67370461024841, 5.46895171322668], [5.31693371282286, -1.83868766869383, -3.88661548154429, -1.16409700350301, -2.83301215550543, 1.50703759198862, -1.0395475624567, 0.964572721629427, -2.74691291205721, 2.70352596772021, 5.18766437941861, 4.26353842346952, -5.54274414223549, -3.6623022181846, 5.98385958710199], [29.3628509458244, 1.36528958779018, 6.64086132010696, 0.385165261487574, -3.24825339256495, 1.1178299601421, -9.27825367841193, 0.551731541145899, -1.99995590191341, 1.06819258934629, 1.80023214004275, 0.426820770333646, 2.2610767418709, 4.15775915066104, 29.5436765595632], [5.55474765145974, 0.760785081300776, 3.01817009750475, -3.29978478515946, -2.98082602485062, -2.81671160924189, -1.53096661672613, -0.886031500035904, 4.74897586270638, -1.18033470815531, -2.10135437838355, -0.247868236247793, -5.44902539342377, 4.01080676086273, -6.60172955046435], [7.99905513553722, -7.00445515306472, -4.87942074011616, 4.64130443737974, -2.52193728503724, 3.74151244789609, 4.7637823551933, -0.687463984379709, 0.690713767881566, 2.49395023111039, -3.62422360876151, -7.54482900959633, -4.36393309804718, -2.44580541055235, 5.62468268647971], [-7.45333689768917, 5.573839475001, 5.41283336292318, -4.28629864505207, -2.75735364093553, -0.23862065136854, -2.37281676314626, -2.41930996807232, 0.497168145249786, -0.438143485493029, 4.47557766000882, 2.3540037285397, 3.61662928329995, 4.4972974081075, -4.34940770953486], [-5.18214847008746, 5.87029483550096, -2.74821211282606, 3.80625704533777, -2.78673771208548, -2.48982401427328, -2.09391203352192, 0.356948151284349, -1.178192907829, 0.820054129203652, -2.77373744616387, -5.68962441343677, 2.21141883523344, 4.02524612385115, 3.46251076714116], [-3.36617447540544, 15.8351193186904, 12.4576690074914, 1.83168887993746, -2.01790122374796, 5.6605781183121, 5.37286377410227, -0.83788710030821, 1.35478942630944, -1.6418518872848, -0.334349060943601, -14.1700923350818, -8.16656795784981, 30.9279754770229, 12.4785723067448], [-5.05702434291562, 5.86608416812416, 4.89322244648722, 0.323642832136893, 0.469871642101047, 5.70614638627015, 4.18695259399286, -3.57162958849555, -2.6706023925481, 0.920869841754144, 4.73871441971293, 7.76583688980496, 4.20076833944357, 3.92906763475877, 9.15926832432549], [3.59679517472649, -5.79013464113049, -8.67603237047308, -3.55045956660951, 0.556087749029421, 0.648072160138306, -0.154309935962069, 0.96273395933409, -0.939494540066811, -1.96732397125813, 5.60038673649084, -2.33027392736687, 4.62201322297324, -5.58163942352602, -5.8684314242247], [6.18004088031598, 8.0717292020667, 3.94056583881276, 1.30569829869555, -4.33052376690666, 2.0227865265161, 0.198494745404811, 0.767903097489971, 0.982233205650004, -0.311067711423018, -1.49042477608041, -8.18454643010912, 7.89964488980999, -5.89915603851637, -7.27136669479398], [-5.64368357767127, -5.58735737338161, 4.01150204841067, 3.52570755416686, -1.77588896498284, 2.64189855187512, 0.413719246693812, 1.06759708319857, 0.151590763152179, -0.992403693566446, 3.58787768221008, -2.82818827669188, 7.00100667766926, 6.25858858055267, 1.24448269852359], [-9.73439173079669, 4.84443257024396, 6.16515289966121, 4.02390510179749, 0.711480010344912, 6.63789326946499, 0.480482208310873, 0.0650545119019467, 3.55528952491422, 1.56615633416574, -1.08052344901863, 8.18544509080033, -2.12146130702969, -7.57337363615603, 3.36522380489437], [-3.00438566184626, 7.78026296685575, 3.75795654998844, 0.914179916872661, 4.36526826553294, -0.447954360490057, 2.8927855535284, -0.295925759903087, 0.509168948752347, -8.27753461498174, -2.51652216245753, 4.10319006908582, -5.13302016340521, 4.16464230465937, -4.87306612304715], [7.24804945111564, -5.28168128949784, 4.17477533367129, 2.71664413829018, 3.08587894428405, 1.79879408810992, -1.29229643777323, -5.61123367525926, 0.718523458163762, -3.48757751953548, 5.82202096817217, -0.349494302680433, 6.2364609004953, -6.12576015002199, -6.30206402193362], [-3.01026194040722, 1.76692901005587, 4.53925047583544, 2.73308406822478, 3.76445296714736, 2.81418285481353, 0.829872241720735, 2.89586847448008, 2.73149139015795, 3.03070358137475, -3.76972171681749, -2.59084283880791, 2.89224089494644, -4.90693964245423, -8.13713232256567], [-7.98896404320616, -7.2620374712344, 15.6168990674349, 3.0671938838164, -14.8964578864261, -5.92193295635851, -0.0698603151561678, 4.88078816120113, -0.339260797356025, -4.0782814763559, -0.0143300681918988, 94.4015560199183, 9.17574585979005, 19.2526169988225, 5.41409832495806], [-5.42815241571687, -4.1792509971915, -5.11504560060988, 1.92607660190829, -1.44518278248508, -2.30007163235874, 1.15906004800424, 1.02186480401187, 1.26605759943376, -0.333964363626324, -0.474136707656327, 0.779688530971104, -5.19136697709086, -6.05633102894622, 5.00138844059556], [-5.16645423919861, 4.83548248851362, -0.400814532298476, 1.95684265064378, -4.0549614484877, -1.6541454712289, 1.90076312141356, -0.983747112936294, -1.21021140002621, -2.03099779586748, -1.96652980307625, 4.4627876772946, -4.84528344041998, -6.48025265605319, -2.45041308267813], [-3.44447901363115, 5.99058662047552, -3.87888768471729, -3.32977254095528, -6.78826036075003, -3.11689955403007, -0.526819113003387, 0.786961396058899, 2.35488198765201, -0.582771541734649, 4.93482327721072, 8.24701198103969, 1.00619729137397, 7.8258602158496, 6.06477480187772], [-6.07204116428333, -1.55359500177582, -5.56837291734245, -2.53978194089368, -2.98798305025711, 1.92359953734793, 0.41482026311878, 0.552802572751516, -0.900280144020172, -0.757343687297473, 1.93257139940267, -2.31754852938738, 4.19391090881271, 5.87493454747859, 6.84261394780248], [-5.87784596278638, -4.77116833002476, -6.05823930307079, 2.85781105816084, 4.29697684945501, -4.85954593400951, -4.03522880822721, -3.50547567902579, -5.92041764604366, -0.607194729187542, 0.246087385074464, 2.29012889920463, -6.52831294312573, -3.19832246883995, -3.40295671998486], [6.15957818624227, 3.25812800437102, 5.96285705809299, 0.718133271625201, 7.68075395771453, 0.890300483451565, 0.741712245201798, 4.05121023398736, -1.88649378016662, -3.0806230709175, 2.39354939979756, -0.218291677615968, 2.83502294771343, 5.52516047341832, -12.6609133494989], [-8.9743051936497, 4.5951155270228, -16.1711000760133, -2.70992704024103, 3.24094313139301, -0.919648173982478, -2.36057723764112, 4.92916778370055, 10.4556888595658, -4.11917240224034, -1.38342221098352, 14.2295704783379, 2.57386292459542, 2.62400313807111, 8.67912822374139], [1.67695473909084, 5.11492704408923, 3.45513592776437, -5.25510857996134, 1.03159539839048, -1.42376462056898, -0.837943380583272, -1.0614674482297, -0.900141326197627, 0.534190604016695, -2.36469021510482, -3.72042926127584, -6.69513875012875, 5.804989899656, -6.85616771032051], [5.92541524106172, -3.39703313369782, 4.42285644773372, -4.3814310679054, 3.20002159882488, -0.921862511229894, 1.09588109724298, 0.417466942052635, -0.370749266787342, 2.06358501600081, 3.55404808707409, -1.47967511026662, -0.842880564628455, -2.71495830270859, -6.20426116207116], [5.2537183685654, 5.18545003725902, 6.97499320379662, -0.698684621271606, -2.08961269349166, -2.09797321256558, 2.16731373814769, -0.0494797366406753, 1.50010282119401, 1.68078482317412, -1.10181442510985, -1.34901946096283, -5.63430524094276, -3.29494493589947, -4.90494825914425], [-3.30194112046116, 1.9920595763671, -3.20274609518288, 7.91693568384055, 0.776718039952924, 1.45032810892923, -3.64661835495149, -8.32005101160435, 0.0221967716867284, -2.8959294957877, -0.120207675086638, 3.91851135171656, 11.0707618621286, 8.10749236452122, 1.56631839653245], [5.6471141078903, 6.17035829266682, 5.22163205106918, 2.4518536204949, 2.43281232078074, -0.334491126972339, 0.756299481101591, 3.59901199019886, -1.49530839877331, -3.62739192945459, -2.57517020175414, 2.34317386547542, -3.05709107614979, -4.27918070530997, 6.73580710728035], [5.5670075010828, -3.2358409519277, -4.69752726518574, -4.2556800279972, 1.2184807974016, -0.606195590517538, -2.59720989144369, -1.11698848832236, 0.576313686974794, -3.16393575393339, -2.73668432635444, -4.07085771789354, -6.36892641428178, 4.57880341055048, 6.23343160383415], [-5.54889659994666, -5.49120088529741, -0.183710629954819, -8.50665521895357, -0.12350527854057, -1.33599015192922, -1.82164140414881, -1.51988641725397, -1.53853792325862, -2.9766140353874, 2.89326020730188, -1.81487678552073, -4.90771020799715, 5.52738912081909, 4.74734678833056], [-4.55493211896471, 5.99010103530803, -4.08329249193776, -6.11740712984474, 6.67815786495213, 4.83667891319221, -3.92460966908035, 1.59701527020013, 1.8187790777535, 0.156989414256569, 0.644951758257813, 3.26860611288756, -5.88718223420135, -8.49020618974815, 1.95978018261891], [-5.61377891888817, -5.07778108054468, -3.33947336967255, 3.41636622879632, 3.00597620701697, -3.54218060020836, 2.93782286557994, -0.284895979551585, -0.180062372153482, -4.01710921645064, 3.04510693680978, 4.70617320241458, 0.706613338081487, 1.62103448006044, 8.5927595193081], [-4.36041880890428, 2.50083136919274, 2.10904137977457, -3.35038169189927, -4.90895644235631, -0.708193208580223, 1.37360066458014, -0.487586596819312, 0.525983606916475, 1.4805678085655, -6.22654405348129, 6.59560019763616, -1.46881584340145, 5.08020688302325, 3.8956375134671], [-6.37018115749256, -4.91919968843197, 0.661419802792559, -4.97430083921693, -2.87166192347957, -4.46577448727446, -4.86013315603552, 0.460943788565612, -1.74161904839444, 0.0561588074928072, 0.199694274079806, 1.59703053875756, -2.5743579226775, 5.70955182066657, -5.60845534160922], [2.60427553268036, 7.15958534568641, -8.7210203152566, 5.23277360471996, -1.03792120876127, -2.05740048748681, 0.155839152246345, -2.30055815526146, 1.91963320383955, 0.307777636326706, -5.30086748678377, -17.0182912805975, 8.97252182898315, 8.84959111500003, 4.41489716979769], [5.27378635267709, -7.19515053127063, 1.156868116724, -3.5579056676837, -3.04233699731849, -1.11282083701763, 0.118763032723906, 0.515618643220467, 5.11704110403983, -0.453848590819535, -1.53498987620998, 0.373466603845658, 2.93907863523873, 4.43004588214289, 5.59116209704585], [-2.35118783845997, -1.36165793093932, -5.23225761145433, 5.15718456580018, -3.17303967184285, 0.335381118621449, 1.12224318815015, 1.16471147057466, -0.680071654293368, -0.159738445386241, 2.48051894267678, 5.70707193150537, 7.23089892087506, -8.83721689823497, 7.67199769442599], [5.38076784226902, -4.84104269160727, -3.32865970214836, 2.2394952929969, -0.975961585662948, 1.01415473732029, -0.166723969490577, 0.790945409539947, -1.56983388657255, -2.40608549920651, -5.5355693984269, 4.00488090506827, 6.1411030031095, -6.32380018764876, 6.64724500204796], [-8.58397899038853, 5.72971409616532, 5.5891746762761, 2.57569650988621, -4.64971739835504, 3.40078865422742, 1.43559641065905, 1.11848046498537, -1.51723359620469, -2.56058316737901, 4.02335956703147, 6.69853052746792, 5.58034488133456, -2.17447067176449, -6.16284602428857]]
    P_means_offset1 = [0.128486750100307, 9.17475243829814, -0.177654077049343, 0.768636427679999, 0.585485112717346, 0.346598997251189, -2.26433864714014, -0.744329381671273, -0.643956163952834, 1.17109808113401, 1.66490061938187, -0.569347253701855, -0.228819952587528, -1.92576311135492, -0.0831245315536498, -3.80390917785954, 0.473431361830285, 0.216409571345986, -1.89310667796377, -0.788381490678603, -2.77625927559765, 1.53625396266513, 0.79302371957608, -1.00591153897678, -0.790883960975758, -1.70109828502385, -1.22113498728128, -0.590645701666464, -0.668404073616917, 0.668712538047265, -0.285669264958904, 0.166840579772473, 1.32370303636155, -1.14122361821317, -2.16119824058229, -1.05014393039665, -0.911939650579557, -0.390817346586198, 0.283757254469177, 0.966268711532287, -2.55376869729044, -1.42555066917309, -1.25794527680642, -2.42639315549471, -1.7971944085895, -0.720735657782258, -1.04160185743818, -0.000801733799801761, 2.78874103508642, -1.26682924596995, 0.160535071867588, 1.23964262553135, 0.0359673141926806]
    P_means_centering = [[32455.5333334, 1.0], [43725.53333356, 1.0], [34015.80000004, 1.0], [43726.7999994, 1.0], [33877.26666688, 1.0], [42914.20000008, 1.0], [33367.2666666, 1.0], [33082.33333332, 1.0], [7231.60000004, 1.0], [43189.20000004, 1.0], [36558.93333364, 1.0], [37103.93333352, 1.0], [34961.13333344, 1.0], [55378.66666644, 1.0], [56496.6000002, 1.0], [54614.93333328, 1.0], [55096.66666672, 1.0], [36380.19999992, 1.0], [36716.60000032, 1.0], [36981.06666688, 1.0], [56611.46666628, 1.0], [55750.8666668, 1.0], [56366.26666636, 1.0], [54399.2666664, 1.0], [37000.53333312, 1.0], [36492.9333338, 1.0], [36532.46666672, 1.0], [37624.19999984, 1.0], [58285.1333331601, 1.0], [56334.26666652, 1.0], [58058.00000024, 1.0], [57089.26666676, 1.0], [55180.73333304, 1.0], [28924.00000004, 1.0], [27645.4666666, 1.0], [28228.40000008, 1.0], [29650.39999964, 1.0], [29016.20000004, 1.0], [49134.33333328, 1.0], [29346.5333336, 1.0], [29124.60000004, 1.0], [28342.06666664, 1.0], [29397, 1], [29807.06666616, 1.0], [48125.86666648, 1.0], [18426.06666664, 1.0], [49232.26666672, 1.0], [18603.26666656, 1.0], [48391.79999996, 1.0], [18416.0666666, 1.0], [48855.73333332, 1.0], [18329.7333334, 1.0], [49284.79999984, 1.0]]
    P_means_scaling = [[303700.66666036, 95.0], [409114.80000012, 95.0], [304107.80000156, 95.0], [387072.3333308, 95.0], [310443.33332916, 95.0], [392659.53333304, 95.0], [326524.33333308, 95.0], [320094.53333244, 95.0], [90085.39999812, 95.0], [403532.5333348, 95.0], [333830.00000016, 95.0], [343339.19999656, 95.0], [331125.26666716, 95.0], [493965.8666638, 95.0], [515413.13334328, 95.0], [487303.933335321, 95.0], [491295.60000692, 95.0], [335931.39999832, 95.0], [329533.86667132, 95.0], [350350.13333104, 95.0], [483466.866661439, 95.0], [485935.13333244, 95.0], [497110.866664881, 95.0], [486568.06665728, 95.0], [344992.26666396, 95.0], [347054.66666084, 95.0], [344889.19999924, 95.0], [336067.60000184, 95.0], [501800.9333376, 95.0], [495771.39999704, 95.0], [517162.333329999, 95.0], [507941.86666428, 95.0], [508713.66666148, 95.0], [278315.73332996, 95.0], [280172.99999752, 95.0], [280317.73332828, 95.0], [275054.66666276, 95.0], [281887.2666628, 95.0], [468212.20000348, 95.0], [280795.66666856, 95.0], [273683.73333484, 95.0], [285799.93333596, 95.0], [276621.2666712, 95.0], [282092.00000752, 95.0], [462836.79999692, 95.0], [188690.26666616, 95.0], [448483.13333028, 95.0], [182746.40000016, 95.0], [468080.86666648, 95.0], [182113.00000048, 95.0], [438149.13334028, 95.0], [197604.73332828, 95.0], [447993.46666832, 95.0]]
    P_means_uncenter = [32455.5333334, 43725.53333356, 34015.80000004, 43726.7999994, 33877.26666688, 42914.20000008, 33367.2666666, 33082.33333332, 7231.60000004, 43189.20000004, 36558.93333364, 37103.93333352, 34961.13333344, 55378.66666644, 56496.6000002, 54614.93333328, 55096.66666672, 36380.19999992, 36716.60000032, 36981.06666688, 56611.46666628, 55750.8666668, 56366.26666636, 54399.2666664, 37000.53333312, 36492.9333338, 36532.46666672, 37624.19999984, 58285.1333331601, 56334.26666652, 58058.00000024, 57089.26666676, 55180.73333304, 28924.00000004, 27645.4666666, 28228.40000008, 29650.39999964, 29016.20000004, 49134.33333328, 29346.5333336, 29124.60000004, 28342.06666664, 29397.0, 29807.06666616, 48125.86666648, 18426.06666664, 49232.26666672, 18603.26666656, 48391.79999996, 18416.0666666, 48855.73333332, 18329.7333334, 49284.79999984]
    P_means_unscale = [303700.66666036, 409114.80000012, 304107.80000156, 387072.3333308, 310443.33332916, 392659.53333304, 326524.33333308, 320094.53333244, 90085.39999812, 403532.5333348, 333830.00000016, 343339.19999656, 331125.26666716, 493965.8666638, 515413.13334328, 487303.933335321, 491295.60000692, 335931.39999832, 329533.86667132, 350350.13333104, 483466.866661439, 485935.13333244, 497110.866664881, 486568.06665728, 344992.26666396, 347054.66666084, 344889.19999924, 336067.60000184, 501800.9333376, 495771.39999704, 517162.333329999, 507941.86666428, 508713.66666148, 278315.73332996, 280172.99999752, 280317.73332828, 275054.66666276, 281887.2666628, 468212.20000348, 280795.66666856, 273683.73333484, 285799.93333596, 276621.2666712, 282092.00000752, 462836.79999692, 188690.26666616, 448483.13333028, 182746.40000016, 468080.86666648, 182113.00000048, 438149.13334028, 197604.73332828, 447993.46666832]

    P_stds_w0 = [[-0.00490975848731802, 26.0789540375901, -23.8006589449921, 35.6812114625415, 0.827969491641408, -5.39518161087473, -2.78610529615945, 20.6398688413753, 15.7016368492, -10.9714255441838], [-0.579335154156854, -38.4843756413491, -22.154251201209, 107.81163450067, 15.9815856202478, -16.3184596950142, -28.7437981586957, -27.6878325904205, -11.2777761908213, -1.90259122503869], [-4.92956366434136, 10.2517472053063, -22.1488849999454, 6.88287732679567, 66.2298769422891, -24.9140525527422, -16.8303825937003, 40.660234680375, -6.12324306664563, 57.2370652919435], [-15.054056990839, -12.6418024574939, -14.1982925438623, -13.6107873097884, -14.019276050354, -14.6486172140595, -14.255888041322, -13.9947364813677, 13.2525099656203, 13.5558044792882], [-64.2429619192372, 36.3754171122575, -5.96157216406752, -84.2068596262771, -344.638207900623, 0.0980577652139058, -30.559892816911, -56.8771492857955, -9.16805450966773, -38.7358701941226], [-7.19938870828756, 9.1108080001888, -14.4997390012661, 24.4373535502172, 31.7557721602394, -37.3363399035418, 22.8624908654031, -10.1895141775191, -11.8188001583567, 24.5133534427034], [8.66969610935942, 12.9199234723564, 14.2091732290814, 28.9236767228195, 25.6963864753929, -27.3519713846019, 3.15666562120221, -9.68715553635402, 14.6125527402078, 24.092734097842], [-5.91577334307342, -30.4263546368604, -19.6708211186077, -12.2664481652047, 0.920786905781474, -8.66356938108255, -16.8261850485414, -8.67170668131327, 20.2943815525062, 18.508244090806], [84.5316357244732, -2.33787196782303, 17.350778309527, 4.20792879305956, 23.42548712125, 1.12153212526897, -23.2737521715575, -213.556597956442, 11.2682218483216, -39.6754647704031], [12.3947205871179, 17.2936094654491, -18.7769773383583, 17.8487119636997, 18.4821533884471, -7.03738469941559, 10.7749356895151, 5.28299544561977, -11.6070648555993, 12.9201462894085], [-7.98209560027504, -12.3298475677449, 29.6551561337632, 1.63118590698619, -26.6107482067511, -14.5644388745665, 11.6782110961301, 34.8453663684445, -15.0431546960955, -16.9373532118045], [14.7927917645273, -31.360705297349, 19.9973465900563, 3.34902046233281, 6.36413598121196, -27.7625381977901, -31.1230744378266, -23.8431608216809, -7.35167737469198, -2.4276683209322], [-90.057679783484, -1.11104155239401, 71.4946053338181, -147.624542212202, 0.140058660891031, 36.6014181967918, 13.2227996815236, 7.27860479296366, 1.00643316036435, -11.9020299817345], [-32.2129285435103, -9.68181393729013, 13.5552667078635, 12.3976598726593, -21.5409788325008, 23.8058366147619, -6.56762691328026, 21.3022841124623, 10.035835518058, -17.7900068997007], [45.9312587292771, -7.23863793309726, -8.64439055289213, -6.52914874431283, -6.83354853392959, 15.2745743266266, 15.9499054259648, 10.3056218403068, 5.57949904820012, 26.5837106889594], [-12.2280480855791, -17.064056259805, -1.34946990682476, -23.0545321247096, 0.685787424165957, 34.7502064261453, 15.069537881189, -15.6888592371577, 15.6711832421205, -13.5782340903883], [13.0557757854868, 29.2161693306554, 5.83036794456526, -3.3887995013332, 9.58490721429471, 15.0555242299069, -4.88441694965398, -4.55230205210748, 15.4546940185246, 13.5829978684292], [8.19925267327143, 18.5869045781787, 13.2685186969868, 16.0100456085487, 22.6131234464707, -26.1391133849005, -4.09122121452825, 13.108190828301, -16.3946777135887, 13.7986727410894], [-10.8860806514787, 22.3562029181557, -12.1006721316639, 15.2312006361496, -9.37623431609563, -13.602683567436, 12.6551588005248, 32.8399622106805, 14.0787087393638, 21.8453507504126], [-23.1083950204564, -3.70005171759555, 23.3290393181927, 8.1908117714328, -20.4490436323344, 23.263966913181, 21.7277292405147, -30.3353016117846, -20.2999305539218, 10.9718277846092], [-7.87780811744625, -44.3555701667152, -33.0229176340152, 3.82449827315308, 41.6885172252611, 7.90178082286064, -17.7926814034246, -9.73179811111463, 11.7002129961756, 14.5149548795011], [-43.0775603608068, -15.5859682646565, 39.4306244105168, -37.3747664109035, 9.94756984870615, 1.0699790958976, -24.3221159141145, 32.6043802909016, 29.1715706678582, 17.2729363094074], [-5.69392477676962, -3.91788023722284, 7.84174587519658, -20.9273032141872, 37.9088425135733, -33.069505286298, 13.0934215691499, -8.41685747081431, 11.5616892381516, 16.2642284685604], [-18.482182730685, 3.22104520603421, -31.3586723553573, -7.79142885168669, 19.9923961079554, -53.7629914632312, 50.6025110982336, -3.94542209946769, 18.1801315032286, 46.2330813641506], [-96.0766500824175, 9.27663210459866, -72.8903582908835, 298.13308469908, -28.8646848506041, -14.6073023455918, -17.9343904192687, 13.4582577352782, -8.91134659776955, 61.2458822164252], [1.58819144638995, -1.36267876334241, -9.97044850742682, -4.25676057162498, -30.646671752991, 2.69475417299783, -7.260329112934, -11.9537382923875, 15.793772983709, -17.4561539992258], [-20.4028237613443, 10.6345548822314, 15.3101335837542, 14.7562817607685, -11.6941886665833, -21.6782943403818, 7.70905106901374, -9.77391488432842, -13.8293293957216, 17.2850973561713], [-1.04865645074761, 16.6917717166986, -17.1379230568474, -23.1277487213131, 2.00869481358184, 20.3385314716513, -57.8314411881139, 4.86416691198429, -16.1358783611753, 14.6927760464748], [-13.9181966270772, -14.6143569101069, -14.1083975436271, 16.4573554860877, 13.7093564657691, 14.5460739936076, 14.270710039, -13.0977920843016, -14.0134487512916, -14.0079613012837], [-18.2555174756516, -13.8402182276294, 15.38781571935, 10.4764218878555, -7.28259868677431, -14.1629319934358, 16.8650077374387, 4.93412632865847, -11.6278853962441, 14.1152339859739], [-18.1801285345783, 11.2518451056113, -17.2395699474864, -0.559779853579729, 80.7035858226072, 46.8396816071943, 14.7986907103143, -19.7633597492321, -6.75363709989636, -1.71656878781323], [13.5339973463437, 12.9132416757672, 15.2644183455054, -11.8371586050083, -13.8721362317149, 14.4548823770965, 13.2268725524222, -14.065330556057, -14.0199726703134, 13.9056479348092], [-14.6043758403459, 14.4195881458864, 14.3977585411414, 13.8956504063649, 14.0902070668884, -13.8359034718857, 14.0640159461834, 14.4238195164122, -13.8787133766056, -14.4620931586915], [26.0920783667497, -77.8231235904892, -5.67933981301551, -4.30900871006048, 0.8498510620414, -10.6598442217125, -2.06588450976482, -28.612052143959, 5.09662827856383, -2.31066983993479], [-12.9687040633564, 34.4833974787554, -13.9336716188228, -0.392357881522443, 20.1196790959439, 2.05974896965838, -36.5294414926474, 10.0107071762712, 11.712372479117, 4.97765823063807], [12.2866167543219, 15.9514045549213, -16.3307347263492, 11.5574676821481, 19.4969963056822, 0.580770888261281, -10.5411311383911, 24.1064343510166, -8.84750424336653, 0.390491056272729], [40.8291394769349, -20.5761328047975, -5.62951745989071, -10.01644368605, 12.8339894432076, 7.8084042114605, 23.9303340622863, -10.9561639080436, -13.3533684470643, 9.46064966666961], [20.4487718785521, -14.9555724622313, -12.0817823999897, 15.0631444969526, 10.0703114752555, -9.69004604713938, 22.0099753243405, 17.7452991080257, 14.0860266227311, -12.0372854415019], [-6.98455478787541, -16.563326905883, -5.40182634711683, -10.050875017208, 10.17436236305, -5.50693419465894, -17.0722961129722, -5.05410395856079, 14.0249491538004, -10.0609420847872], [-3.35268848170843, 16.6971829596627, -32.8236359476182, 21.7350157444, -24.0576206495838, 56.2652881344422, -19.4079294794944, 6.90673371338973, 7.33684213476677, 0.45136609226559], [-9.70267318526263, -12.882615902958, 22.8169702966925, -11.4044862556001, 3.26036137814643, -2.03029914874982, -6.96708636528879, -21.4549399778044, 13.9231988217808, -14.668444172861], [-6.28754544793034, -13.1032534752054, -1.91073899662533, -19.7857395993198, -5.26594097210338, 57.0403931267485, -9.98929819081322, -13.1919382583742, 12.3492080718949, -14.8036860355994], [11.8301906328166, -13.7060908161963, -11.298616638736, -27.5491447910131, 19.19507571268, -13.1329767736863, 18.8281511141086, 1.97624243157018, -17.0756819114695, 16.6389511239585], [8.5197397093995, -21.9867087173161, -28.030107290535, -28.7347323396208, 19.9234760103802, -8.63531473116218, 11.7450809533487, 17.6167990844674, -14.3293557880104, 17.6952178878714], [99.2344252160552, -23.9906015933721, -1.01406935529057, -20.0258175310453, -0.399577985508698, -2.61528651404782, 5.39474720785071, -82.215046616444, -2.5938766450661, 31.0666642826341], [13.4694308110576, 14.9522973008476, 12.7351136150588, 12.1390471928856, -16.0257152239665, 15.1390558794049, -11.308047814801, -13.6952725041368, -13.6495300446964, -13.5706990837572], [75.5049846415044, 24.4584949546218, 39.9302694048202, -113.484703452805, -11.0533062032862, 14.8376606684556, 89.5848187893134, 11.6583078685662, 19.8284539775549, 2.58908888791376], [1.18053508476169, -8.8800030652729, -43.5277418098216, 9.62213323756388, 16.1814707763636, -27.3832072752595, -1.81349318766593, -13.0444768257988, 12.3117002888413, 11.8444610511349], [15.9296517769082, -5.62563743976815, -13.2028619340509, 10.5551658119615, 16.1822044678993, 16.6391242971118, -12.283847811087, 15.5724168143253, -12.6909655548692, -13.4755842024204], [15.9318474262575, -17.8229682736889, 22.9648239974599, -7.16149502112313, 39.2334613836377, -48.3319625658936, 40.8719602487915, 20.8897855484315, 17.5772277360297, 10.052330075554], [13.3128703122268, 12.2591880656858, -4.95473706223008, 10.9034118103238, -9.28274665412651, -21.0832499749965, 13.9999989985737, -14.2596387083005, 14.2874095798748, -13.9604494678688], [-7.54734987571603, 8.36357702933273, 14.0409530896376, -7.13290705858701, -15.470058988014, -24.3274710657844, -3.60891738631732, 5.75519236275572, 7.01828289497976, -12.5342873428516], [98.4385359638061, -22.1711100820594, -1885.57394309433, -12.2152082647444, 4.57176060525796, -238.66055191209, 93.2498269926957, -133.18782419722, -29.7949175789953, -14.5650168090955]]
    P_stds_w1 = [[-0.241837199086701, -0.0855833855320855, 0.170543880342748, 0.252397537934551, -0.587731296193596, -1.23658115390908, 0.616907389377732, -0.249521281376275, 0.126186092476079, 0.481503513775837], [3.59313661293336, -0.0102208970569352, 0.136471222158348, 0.235080753110093, 0.057381031793589, 0.174711911640572, -0.192282857647763, -0.442390510907052, -0.0551505804992413, 2.671230558787], [-0.526524779374895, -0.497041053274598, 0.0342297171635287, 0.428903842460011, -0.178498870913377, 0.112767020872459, -1.39053617183299, -0.732326141150796, 0.155154978554299, -0.197482264415709], [-0.362666454015069, 0.574711217359509, 0.307397777589696, -0.349764500066286, 0.0556896126906398, -0.00730069149347701, 0.0706064182334309, -0.665770298498306, -0.131861267025051, -0.748116115327402], [-0.252453351099522, -0.346347775228931, 0.177342259279377, -0.193344603051194, 0.0602193510778833, 1.7803261404647, -0.502331132749554, -0.123802709247277, 0.13732217584988, 0.0999041090626636], [0.326685515513013, -0.924856951981477, 1.01522259034181, 1.38621408319053, -0.278740888332178, -0.0142725408525309, -0.350218096585047, -0.936613230817136, 1.05085085087159, -0.156711976388235], [-3.95053851599893, -0.40925823003255, -0.170191099375925, 0.271396315766369, -0.105388104280261, 0.051718637814468, 3.03430558287397, 1.61297093657273, -0.728342124129496, -0.44111055357681], [0.888640842192537, -0.35257045460321, -0.229708699980217, -0.0890974661093359, 0.324106610009629, 0.34890955834129, -0.0166471809683143, -0.82833377460887, -0.0261043659810904, -0.183687189103356], [0.30613107385374, 2.65918148493933, -0.795984031100476, 2.37866059474005, 0.123137942137602, -1.27616623966791, -0.198587866937905, -0.0363985063695714, 0.735530691881733, 0.115998758458416], [2.32500035682034, 0.101421845280456, 0.268982735789793, 0.360873935035959, -0.20325239159553, -0.177514468741156, -0.88174776640821, 1.57417322522551, 0.336336469840405, 0.00403282669847409], [-4.81472584998014, 0.323680759299308, 0.0190624292699498, 0.922025233269084, 0.11178002065579, 0.252939251850153, -0.335327830278656, 0.137159668612273, 0.469280259070808, -0.495285040498348], [0.559123949352339, 0.261335388758137, -0.871492902267294, 3.12106969378973, -1.73733214752829, 0.0320808111876874, -0.498206778854389, 0.482129665733073, 0.343547138393849, -0.678079533528551], [0.24242252186099, -14.6406061488769, -0.107033501913419, -0.195856303861965, 2.01077404365877, -0.176565777409676, 0.669250251705205, -2.77585866542617, 8.08395362708769, -6.28134080644667], [0.212826023915298, -1.10901936831259, -1.06152653748798, 0.0930163929892333, 0.159518481744153, -0.0276587359812927, -0.848047922560973, -0.152663596377378, -0.15637556506419, 0.188794245280722], [0.264811509498905, 0.616947526537169, 4.88955125671736, 0.00109111699903259, -6.40320218257431, -0.943314568194835, -0.794530157807445, 0.928951743918954, -0.26619542058057, -0.261558218230551], [0.288102073501739, -0.0960188813482319, 0.766848634464888, -0.33535635599489, -0.518233463932446, -0.459732874344704, 0.693674861781778, -0.727135608721833, 0.0527860314612731, 0.671747032044449], [-0.31334344574269, 0.371746172988092, -0.339007851473762, 1.72793175989354, 1.15552659634043, -0.441883955291499, -1.74297761820143, -0.719673186066182, -0.530341963778094, -0.351200221068262], [0.085334951814353, -0.0970580281408043, -0.212063461607321, 0.100607929853102, 0.172596166110923, 0.0258406659027831, 0.569706741261114, 0.952398929436869, 0.0641837075891519, 0.74607309973836], [-1.29124453036458, -0.275661256073436, -0.0201469539344151, 0.40504477598993, 0.291181964163241, -0.12035100608022, -0.297096145541751, 0.689116543830432, 0.0173685032300213, -1.73027533080896], [-8.12537372593836, 4.73757112102762, -0.987698612427825, 1.26070338131588, 0.0785429955518145, 3.64635264891785, -3.66192485364784, -0.531154806792198, -0.120451429007994, -0.252715501418262], [-0.476067024171907, 1.17707339898626, 0.0957938688572134, -0.456252858789791, -0.0525293108993526, -0.968429832967255, -0.00519731931115485, -0.677134064914383, -0.758783096126964, -0.535320598994306], [0.0933163217567622, -0.011986991871469, 0.145335065316293, 0.517881692594509, 0.380371030523489, 0.197462953324624, -0.41747024614851, 0.166159600345089, -0.0324476469151721, -5.17246228510676], [-0.958600725706491, 0.942881994658992, 1.25615297240464, -0.628731164389581, 0.191490658194132, 0.670486694240104, -3.62991012629827, -4.94406575464416, -0.171923847095408, -0.032014813102359], [-0.390762059744568, -1.98390999720863, 0.196137218452436, -0.875234477019625, -0.590664217723909, 0.15074176998139, 0.205510137228759, -1.23777001217729, -0.585573992982086, -0.206188129849668], [-0.208537953452652, -0.533705334993623, -0.170390740604472, 0.0314865062341552, 0.196841268821707, 1.32365050853061, 1.99622536324945, 2.71618739551426, -0.387120430908836, 0.219676901152783], [-2.61284568901597, 3.7639711768541, -0.453148704748565, 0.2297696484215, -0.392476383306033, 1.63191726917299, 0.471170187870938, -0.917419303550937, -0.804282855944018, -1.08738671990942], [0.109148847947883, -0.183269599720235, -0.108524246706256, -0.361628707920811, -0.616189902498114, 0.832553799007486, -0.608456806829015, -1.28912605940289, 0.264653919386305, 0.824478207052202], [-12.3083727494836, -0.324641056286024, 0.156306506623595, -0.140483015628788, 0.277315307317435, -0.210668239742974, 0.201383468849008, 1.40543711712539, 0.451551506683308, -0.400576957141077], [0.0584486559632926, 0.144830341327684, 0.0758425098154757, 0.0931354581109902, 0.0351078483392194, 0.087236260683824, -0.139651783688412, -0.620849751604727, 0.104058308582882, -0.213862779607236], [-0.145230097983403, 0.217803720522781, 0.0618876512370677, 0.105101887245611, 0.0860952245913226, -0.171321197838267, -0.284359324390198, 1.01090541213505, 0.441818048416404, -0.167933454503393], [-1.59948181945573, -1.95871931608405, -0.314410133859739, 0.345146730028276, -0.034793794225485, 0.0878242733490404, 0.648373738913221, -0.640958778373689, -0.086631905823959, 1.27180942709165], [-0.678589368366063, -0.233516947753191, -0.247742058681819, -0.412661773833704, 0.213818963728408, -0.0112105544188595, 0.345254431155867, -0.38352364475431, 0.0711119169594159, -0.857015130763324], [-0.36207737280711, -0.183404877643778, -0.218086381491756, 0.331909166653837, 0.0361418111332259, 0.0222473073152349, -0.120978500456156, 0.663712182823753, 0.00595873185406166, 0.194663280059188], [0.0447618602320976, -0.177833965805832, -0.294501359132581, 0.671583326112958, 1.84952037738499, -0.00838058951721819, -0.530943689165045, -0.506719810601489, -0.817523715513801, -0.70382965686819], [-0.172105907244521, -0.153379950172567, 0.110032709337192, 0.524239386895868, -0.00561795064758564, 0.644903886141784, 0.113707265291634, 0.101604849620191, 0.65393369288716, -0.930630146438105], [0.0695924712423259, -0.238803649691834, 0.163205809343038, 0.565453283044262, -1.06779484371382, -2.25953390627663, -1.18030210802625, 0.348986065670054, -0.774599141904507, -4.88110753794398], [-0.887733681695498, 0.208801629353656, 0.746411841514189, -0.250819671925247, -0.0497388501542323, -1.3706846328579, 0.785262350844113, -1.82815023320789, 0.250542967430409, -1.14916705665599], [-0.00365361719985444, 0.168934966403596, -0.240040623743541, -0.115792133056956, -0.0230351831209265, 0.311065283753395, 0.00836835401002984, 0.82536750718579, -0.0157384218967572, 1.0676418268158], [1.17838445624641, 1.27522486591521, 1.97652128340698, -1.1398425078263, -0.636543496801628, -0.926484421965832, 0.20850976229323, -0.890243573884554, -0.250758237696328, 1.7872058851205], [1.0169715244996, -0.346859072711418, -0.0560127422883388, -0.0814446663405996, -0.152142215892783, 0.191270683066822, 0.315298859623713, 1.15957194145115, -0.516417255120399, -3.4475633643607], [-1.14784945945675, 0.126296305767217, 0.0765046773804156, 0.692500593623729, -0.122572269802141, 0.727914951192678, -0.555452648863138, -0.627533434460886, 0.0125067885239328, 0.554086149190147], [-0.174366237268043, 0.49546955658214, 0.0827294649700454, -0.305823797700651, 0.301189996726232, 0.0256643428466066, -0.305873093558797, -0.354284873346088, 0.0182291564066433, 1.16702377981972], [3.35125005117631, 0.137623641525938, 0.220240208420424, -0.0411555854021586, -0.400939377804953, 0.340431720042687, -0.728754703552191, 2.93989057029064, 0.344426990379015, -0.35678926920161], [1.36305560683129, 0.218108475216738, 0.05636800194824, -0.364244357811288, 0.919059097508416, 0.939466544070068, -1.08711405328596, 1.4371083629058, 0.0776298787782094, -0.343676746016398], [-0.340482477465776, 0.0956950808807516, -1.31398470738121, -0.625786201059475, -3.37269894704984, 1.27412423814661, -1.85690519374534, -0.326394630093119, 1.19923155531887, -0.321237849033876], [-1.07807688100765, -0.13704111550895, -0.148098197617225, 0.311040776499761, 0.105679024896319, -0.0638125735313683, -0.0398937611086665, -0.608793826534348, 0.12081685490375, 0.448995935817421], [-0.175768329628227, -0.0445937130640822, -0.204735743438195, 0.270366958963778, 0.540094897599704, -0.618628235859298, -0.260609272065948, -0.294483923520723, 0.389883433533187, 2.23992168540246], [14.8808204187553, 2.62357547166995, -0.240743313993905, 0.787346366679061, 0.275413932727802, -0.212255148796854, 2.00217032006638, -0.894596158148858, -0.221178450877342, 0.0363903098381709], [-0.275144203722571, 0.840648177740549, 0.280307279853705, -0.316032757776758, 0.426518272135547, -0.974631621155757, -1.78751170919399, 0.528946498600391, 0.304211344339334, 0.849837420840235], [-0.181565454418974, 0.406190737029769, -1.61440444392468, 0.252170355220119, -0.0610725761577682, 0.234307300367174, 1.56174944950048, 0.673446325050983, 0.331367409867386, 1.65748453092155], [-0.709261069105917, 0.0875172995787, 0.429860200585726, 0.361173481709551, -0.0254074615184911, 0.150621618074241, 0.109002745924219, -0.482168391005241, 0.0442785842175314, 1.20567725151793], [-2.16197970800748, -0.43059082538277, -0.814992810345056, -1.07327275555323, 0.0132732282928349, 0.343339316910421, 1.29094830070012, 2.06035802089866, -0.292035961537527, -0.452668510052242], [-0.0576159249406301, -0.13061080944659, -0.150822931731412, -0.687851342497085, -0.948113578824599, 0.0360115095405618, 0.223500532426209, -0.294833836924358, 0.0112799488765785, 0.337686832093614]]
    P_stds_offset0 = [[-1.61158926016147, -21.6011031228218, 14.6677452372495, -12.2099021675551, 0.759930306477136, -3.00150873840953, -1.92836995674569, 14.9249970945469, 12.0066988515726, -11.3916104894503], [3.80691781550866, 29.8100563700145, 10.9293769158347, -31.9504265861358, -2.33558225753644, -1.52960318016203, -9.12689000375007, -15.3881147839325, -9.23243556155258, -4.06928090080867], [35.3126814646308, -9.69234803809006, 15.2955283951643, -1.06080598357964, -5.42730860241117, -1.61343517803426, -9.27872529743142, 23.2016960748247, -4.51486106530842, 54.8858642671994], [12.0393769087364, 10.8073323242026, 7.68238259148847, 5.1358909615885, 3.0561171470386, -1.9271837029192, -3.91101492633321, -6.97227452012103, 11.698600587878, 14.193746099512], [64.0603142303655, -32.8519202475691, 3.18113501884626, 29.2966186945409, 24.1674788787543, 0.519236893681, -14.5893373842363, -33.4694694884936, -7.58630974396247, -37.8575856839057], [10.3514336899494, -8.96357242405292, 5.50719774668524, -9.1455513165817, -10.2785577115828, -4.19837370757786, 7.9275413205376, -4.59019602979733, -14.7863798167186, 21.0701500508942], [-12.558781100032, -12.1524787176858, -7.9327663833647, -10.9327173085854, -1.34004763558114, -3.81442227459549, 2.5843598484624, -9.75372121132111, 10.4018090186701, 20.4933785219149], [4.60808583535583, 23.7730285111383, 10.2505167083647, 3.70829103339353, -1.73419163276299, -2.79527621719346, -6.22060880633522, -4.21461326620694, 16.5104340418846, 16.0512430597285], [-82.0699212683579, 2.25036541900229, -9.84435352699379, -2.42410720600978, -0.595439917271797, 0.109084725255095, -9.77002670782556, -165.360492643117, 5.57249534008406, -36.9099676494087], [-15.7211431477664, -13.1784059064873, 11.0854729047216, -6.04034863043006, -1.9670085335144, -0.663603319908663, 3.57427020342045, 2.40381129388655, -9.15284987008404, 14.9547885308317], [18.5172851857824, 7.84119670236298, -16.1716887096891, 0.106416571505369, 2.41292970985496, -12.9041867505333, 2.30298951537862, 21.6044889791547, -17.0320514039499, -7.87272616623191], [-9.6379233520235, 25.2174195436586, -12.2321309557007, -0.852040352674258, -1.17999040611423, -2.39290239591774, -15.397957736254, 11.2710927448058, -1.46889872820414, -6.19823460000961], [74.9510872082919, 3.41058345861848, -42.8026843038374, 48.0697458379699, 5.41075482065981, 9.95669825030531, 6.12527229165996, -15.1368486599169, -27.1509587979289, -23.5617337585552], [30.2027013777116, 5.07688857999082, -7.53886240495721, -3.87443109527213, 1.2775466867902, 2.29783591238665, -3.57018806691746, 13.9292351044428, 8.00290510634674, -17.2883134910536], [-38.8846323900153, 6.48917128176351, -2.91248696796542, 6.17161075487714, -2.27192679892065, 2.95939445232241, 6.98978825448822, 4.56742359773551, 4.08043861233307, 26.8810678871799], [11.7066160706914, 12.322847838936, 0.061191359856194, 7.14041067979919, 0.601506325584179, 4.02170498234349, 1.53502181379064, -7.89574556198657, 11.84240028752, -13.7499860619647], [-11.9174865450706, -23.1251051238011, -0.918147183084868, 1.3890893875262, -3.60957662547093, 4.20434485288887, -2.78447253545129, 0.436160355245344, 9.84326806425638, 11.2650848844673], [-3.36073487011009, -17.6875125706966, -7.19251358909935, 0.825609057987459, -6.2530480155043, -4.67738409388234, -1.28585270811878, 6.52880484784328, -10.9967954446667, 17.149732128253], [21.0200757726521, -16.8942517937735, 6.63974405557846, -6.81534509347259, 2.24747820948025, -2.58591298554856, 4.79488850163343, 21.9754512949481, 10.8044742048967, 20.2935432076359], [24.6569145583517, 4.74475976140835, -13.4143726955247, -4.49370923575697, 0.877189134632589, 2.68112955514607, 2.62948017028617, -15.0769612265004, -14.1704659654853, 9.47311361818679], [31.3456136070685, 44.6462784234969, 18.8783806644099, 7.80777735368271, 3.05185982101141, 54.4568795370268, -12.635051657034, -4.69238013521334, 14.6971897107347, 14.2942269557965], [41.1196016905343, 14.4110206147906, -21.4553953399634, 20.2047273347241, -4.48642106442547, -3.78923966660632, -11.6488305416436, 19.4356196843092, 21.1692296935611, 18.0221704627371], [18.602629136529, 1.37014227756185, -11.6038589549087, 6.88519932711988, -4.26010709536594, -7.66296454605979, 4.64076601686823, -2.97802498397516, 10.537721954764, 11.4303447938298], [15.9468707983191, -3.60843579122306, 17.7095525690411, 1.83679961527874, -2.89297853121171, -8.05371146320143, 22.8539411270264, -2.70002232765223, 13.7747770530052, 42.2322896389267], [91.5459799837553, -8.37698618483214, 33.4065485307694, -54.6958243067866, -2.58576143499583, -14.7489641321616, -7.61187151595507, 5.84404645139921, 16.9877630219758, 59.1063905675763], [-4.23882363343853, 0.658944794256356, 7.72700524191611, 6.83265745238749, 9.64405257013123, -0.711790087226241, -5.55353757170493, -5.96832445665419, 12.0464693315759, -13.3468334596538], [11.3636408805002, -9.20030874467888, -10.415552418525, -4.32429938845256, 4.54871266161342, -2.85575799194735, 2.02676375265038, -1.6236493098997, -12.7679257268978, 8.74273174178035], [19.4684663837595, -14.967272715989, 11.7546386891728, -1.47014566995452, -0.649861160771732, -0.410495026219776, -17.711314461466, 2.82664339641994, -10.6405088702128, 13.3066533302247], [14.0339039727567, 11.9163196366318, 7.49077804200757, -5.49371747232398, -0.856625968803069, 1.26703356656129, 3.73078652108334, -6.62468891148819, -11.1099618990438, -13.418540765798], [8.44251819885518, 9.06550038756272, -9.38132259530731, -3.2564716390168, 4.35482384180687, -2.54537678858828, 3.35597109303328, 2.71821445542878, -9.18201705707088, 13.879742911336], [13.5061871870425, -8.19642900572129, 7.95126267709346, 0.724965935365716, -6.95857357872539, 3.76337629542441, -18.7806628444862, -10.1981803283257, -4.4483376665268, -2.12256122072544], [-14.3231225411535, -12.4209099306616, -7.43390910193135, 5.07086426756406, 0.751301782618034, -0.626094920234226, 6.93861633316993, -7.45597765986048, -10.9179533542488, 14.1547420629895], [14.2920682817748, -10.2873007730022, -7.95620799028584, -5.70126761063469, -1.19675740680046, -1.31447818500467, 5.21408039999592, 7.03199985282193, -11.0828640943539, -13.5576597836556], [-4.08540929523686, 57.8680041201804, 7.04629967116684, 3.56129285998365, -1.73448611330565, -2.31290243342501, -4.23762508323469, -16.3709976809232, 5.0561654083258, -2.72063792218121], [9.35649607491166, -26.2338453055703, 8.83130765767527, -5.39855606567021, -1.11329968929358, 2.07905573722529, -13.8524950982967, 12.5929748784033, 5.8258636908007, 4.94985433839759], [-23.9809382359595, -15.659634143568, 10.5432086524807, -3.94081829055712, -1.62750856675626, 2.22995645247833, 0.653953609970823, 11.1175279519139, -4.91031412986812, 0.619659391796095], [-28.5870145123989, 17.393887212226, 21.5018860016489, 3.28994195215249, -1.34158062076085, 3.40142718545643, -17.4618594763217, -5.21364391563949, -12.5499838815539, 11.5254918156176], [-13.394340173429, 11.9235813958539, 3.90165642944855, -9.12917653697255, -1.23317344516913, -3.53136037412198, 2.85735488484889, 8.38891606580831, 11.0396355575212, -12.5653316716788], [7.45948172538714, 8.81136891086405, 14.3368456069233, 5.11979907051895, -1.14138893913973, 0.816375442161719, -1.83235982786991, -2.80605849765718, 10.117341065869, -10.8781064091414], [-21.6840872409502, -14.89508728185, 24.1130535027581, -4.03687347358155, 6.68547105966445, 5.54346494654479, -3.72062409434351, 3.70181623967633, 4.65073783126411, 11.565079319983], [12.3532116235201, 0.373780061039425, -4.96183378185231, 13.2238408688615, -3.07641960237998, 1.15256434279172, 2.89451359580297, -10.1808774935419, 11.1455652858742, -14.8973742970759], [9.03379107873472, 10.6459451790104, 5.76546668380607, 8.78037989278041, 0.877492978878103, 4.676836487036, -3.39475589217294, -6.7024481204407, 9.05159314306853, -15.1008643803336], [-16.1317914242307, 10.8367961888768, 6.00813866921327, 9.08746518452263, -1.56928279399244, -1.21227175945189, 5.09840117944194, 0.6242523902237, -13.7023843887166, 15.3779012368136], [-9.93005728930146, 14.8202021602564, 13.2824143579253, 6.69218652553334, 1.20722935617166, -4.6010388883656, 0.599138149793939, 9.10989902492006, -11.432572394026, 16.9175996338873], [-88.1418578145698, 13.2732362681916, 15.9609134953833, 6.98444252636233, 0.0546864505235697, 0.718457694430178, -12.421906081755, -43.7950778807758, -3.08100232370263, 30.9009741912804], [-14.1793689301691, -12.8925961631465, -6.74509086428476, -3.97440619652074, 2.38700348749714, 2.49150749986666, -2.82300983398081, -7.2771811532614, -11.8234699432853, -14.2139088685481], [-66.833212422529, -18.9677983922318, -23.2662129239071, 20.1129625348006, -1.62267689467001, -0.306837326691935, 30.2087367589835, 10.7199959347434, 9.65395170302111, 0.107907567702942], [37.0567589612171, 10.2785437180507, 24.1754405796244, -3.05431825618548, -0.476100621839063, -2.75685630794249, 0.406445752665475, -6.65441655945518, 11.4092847061995, 15.9087060396296], [-14.3036409793568, -2.04986873407518, 15.5656550110746, -5.09204129460565, -6.67642160318881, 7.71494148185716, -5.83963074897656, 6.35612624676161, -12.3322319234967, -14.8164412017576], [-11.8340016558459, 23.0274324859111, -9.83045808531084, 12.1950284311347, -5.94042382572955, -12.3368019010671, -17.7379779392129, 10.279187792833, -4.51224476861245, 16.0587665366072], [-14.6656263357479, -9.45332272112343, 3.04295830565831, -3.96290626580885, 1.34332675479903, -3.79818800619542, 4.99583812277758, -6.86282899164717, 11.3058959982863, -14.1348748384873], [12.4789904071594, -7.33666063688388, -7.80556442828041, 3.79429538543433, 2.31077365309037, -7.26541927559077, -1.62636598722357, 2.59066873885467, 7.25423341848139, -15.0933718232377], [-92.0994933745138, 17.2436581431842, 1128.93323068665, 4.34243019868819, -2.19801546047178, -20.854593494385, 31.4008912155938, -82.2523580842578, -22.4083246662884, -14.3889566658084]]
    P_stds_offset1 = [0.265125441959572, -1.27141054703601, 0.0848880537191923, 0.400383432782871, -0.974735773783659, -0.248119765294507, -4.27741917026773, -0.194852275125058, -1.24669531019922, 2.2898346082481, 5.16175202383985, -1.00398613492636, 11.1500941362559, -0.303293787827493, -0.254835918008573, 0.371451493359408, -0.512571602627778, -1.10251692936971, 2.5645795008173, 3.48008523251439, 1.62019964982589, 4.92595027451365, 1.99161725516562, -1.71713651131814, 1.03097844840895, -3.81805866075515, -0.0988708450596476, 12.0347714476007, -0.55852447797842, 0.014542557635839, 1.13976076150073, -0.272965296595579, 0.234536092065356, 0.889913711986361, 0.429561052739408, 4.15458811211669, 0.0891921872041296, 0.61551562733029, -1.73238725231, 3.97699826808149, 0.440950767373335, 0.542893045881851, 3.11510109336603, 1.44122126762136, 0.281591484578858, -0.856596753216514, -0.134445961871058, -17.7382005511792, 0.340430618463744, -2.69666856926196, 0.0973128368844717, 1.46536162116131, -0.0886557505053337]
    P_stds_centering = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
    P_stds_scaling = [95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0, 95.0]
    P_stds_uncenter = [814.976529098928, 708.309641099277, 810.729904108121, 849.784153920649, 917.802805078267, 963.663026343057, 778.409528167568, 874.677913440212, 479.014512076445, 920.671699066359, 886.83124991292, 958.731745072889, 1128.87545504912, 1076.08798915041, 877.786619476496, 894.75411710097, 1517.53382050913, 1037.60791089902, 987.768033496251, 721.116893353486, 1080.33018565913, 1392.48617511521, 1024.97807004781, 1019.85553774985, 825.015610104544, 1141.52472191381, 927.198141503131, 765.977718204549, 864.319638200909, 1505.69030325586, 1209.42321449925, 1230.24978115956, 870.628004202586, 828.414857808756, 691.493932497804, 774.760668738487, 972.84201045622, 1080.04966411192, 913.723337183756, 703.889568344143, 753.157625917496, 991.288531691648, 893.894819796507, 1094.71334757264, 1308.54467495652, 544.481160588271, 1113.13361158053, 803.867750406865, 1196.5259673216, 751.963948961106, 1266.10373178262, 731.929339243096, 988.209966566459]
    P_stds_unscale = [7765.05880752881, 8493.73752730583, 7106.20114145745, 7797.17682381207, 6937.27773365188, 8476.97627817486, 7609.77044593908, 8049.75813882724, 3534.52079092424, 7343.59049686418, 7556.32190049831, 7550.20571633294, 6760.90549396376, 9663.96093935069, 9754.69007062617, 9422.31606225052, 9352.19184039503, 7462.52997895365, 7244.96734279156, 7759.39425116182, 8741.58044310581, 9724.47007291091, 9617.13856754316, 8631.12032057748, 7458.06956747345, 6844.38959066747, 6365.44441300415, 7046.56887720155, 9034.45163203535, 8360.23596933551, 9520.35491232109, 8901.64037873503, 8925.68882783508, 6688.11597090644, 6587.88383382612, 6588.92143434005, 7500.50316043314, 6615.17455566348, 9660.09472026341, 6856.67985796074, 6800.56735053606, 6351.25710595982, 6074.37131152799, 6721.07083133557, 9643.66793418378, 4982.39993693735, 7815.40840219448, 4530.8810516639, 8490.6035063965, 5178.27006267648, 8362.13068968849, 5543.41333803586, 9813.53939354827]

    weath_means_w0 = [[[-2.75383591966483, 4.55380397653574], [-4.99181034404012, -1.26098272142412], [2.13138628903806, 4.16119828969451], [-3.05254536562757, 4.6413667116298], [-4.93457475403827, -1.57035210949737], [3.01215256461991, -4.12079188089518], [1.61030981109337, 0.246859282680925], [0.479156136114527, 4.79916041173559], [1.07597042006249, 5.29003110512878], [4.52736977148824, 1.263786627068], [-4.19940278860455, 0.0909697484508574], [-4.92462338705008, 3.05771821598296], [4.48773265029193, -0.11406296151756], [4.22800397556424, 3.34468580261468], [-4.46590101822903, -2.25740553751221]], [[2.65114414011389, -9.14076259948111], [0.468379022040102, -3.01128736886402], [8.01720083649517, 0.574296239694247], [9.13777410354556, 0.680304301424728], [-6.4281248517441, -5.43083234689197], [-3.39777188526448, 4.63517248661804], [-0.7479878456289, -0.180756362757082], [-1.35799822192648, -3.36389276511178], [3.75938892056544, 0.278466058775147], [5.12818277461739, 7.87621651142644], [5.06934201573436, 12.3757655347041], [-3.66800897458447, -0.0119203235968677], [-2.81682262343792, -2.24958834720911], [-4.95261547173481, -2.64606179844831], [1.72421520147952, -4.35887290848218]]]
    weath_means_w1 = [[-0.0810344408641313, -0.198713160900024, -0.0724204857551513, -0.0310974365660305, -0.0787683768725965, 0.030240111770151, 0.584987003759102, -0.0348635733663963, -0.0100661075489685, 0.0420251520699419, -0.053889288892172, -0.0116595823081146, 0.102974188423841, 0.0145346425190527, -0.0596177146748658], [0.0318629632167054, 0.0571552281753128, 0.00973443844398316, 0.0660435369156756, -0.0501563781299689, -0.042767194519102, -1.31305118473986, 0.198663321437047, 0.0434713399328758, -0.0110786671323393, 0.00293412765435829, -0.20448198523561, 0.092987719622022, -0.0408272294571098, -0.199293175503498]]
    weath_means_offset0 = [[5.73753351722251, 4.85498704751939, -3.81092160635961, 3.24331127912661, 2.79282735178712, -0.528452918804958, -0.110552136982428, -0.979783385463957, 1.20013633703633, 2.5690771539282, -1.88563773983608, -2.48315093535398, 3.51577894912624, 4.61727298121907, -5.36009385954975], [-7.10526969707856, 1.63579697820424, -6.21504060404498, -8.0924204114085, 3.69627381020876, 1.71690450007047, 0.0446095401701543, 0.833258770516059, 0.878650672553193, 1.46925010997121, 7.62871139444702, -3.41699731690089, -1.23132152565581, -1.47354751666501, 4.56773022111683]]
    weath_means_offset1 = [0.0936079067618061, 0.1335518258]
    weath_means_centering = [[-0.2, 1.0], [0, 1]]
    weath_means_scaling = [[16.7, 95.0], [674.7, 95.0]]
    weath_means_uncenter = [-0.2, 0.0]
    weath_means_unscale = [16.7, 674.7]

    weath_stds_w0 = [[12.8136750170768, 10.4351029732453, 11.3380570666449, -11.0115145410401, -11.3997762637397, 10.9379761020273, -11.2564562409558, 9.99536531752678], [-12.7699240464634, 10.5767359493339, -1.88549403305328, -15.3681019727461, 15.9312684219173, -4.82794212244374, -10.5711720065109, 12.0607434114133]]
    weath_stds_w1 = [[1.33752202760707, -0.130426577345497, 0.0354013719814175, 0.0975033784761698, -0.0797369916656664, -0.0105996531441623, -0.00362203847135636, -0.111582483557476], [1.17200375572263, 1.64887496842139, 2.30726788929626, -0.64029112687969, 0.437548568320628, -0.64678192939519, 0.116975494770493, 0.00362115506956388]]
    weath_stds_offset0 = [[-12.4916792282038, -8.60221727466517, -4.4995009004321, 1.73910080065768, -0.732529527665533, 5.40308093269801, -7.91425731428042, 12.3527902865296], [9.9210097974913, -8.19971000911705, 0.740291279519958, 1.14699826115981, 2.91379662011783, -2.38393593425105, -7.05508893877847, 10.3674910000031]]
    weath_stds_offset1 = [0.392440428550603, -1.21038345011411]
    weath_stds_centering = [1.0, 1.0]
    weath_stds_scaling = [95.0, 95.0]
    weath_stds_uncenter = [0.216613410293261, 0.0]
    weath_stds_unscale = [1.20150881429199, 70.3754470331612]

    features = theano.tensor.matrix("in")
    centering = theano.tensor.matrix("cent")
    scaling = theano.tensor.matrix("scale")

    scaled_in = 2*(features-centering)/scaling-1
    weights_0 = theano.tensor.tensor3("w0")
    offset_0 = theano.tensor.matrix("off0")
    
    hidden_out = theano.tensor.tanh(theano.tensor.batched_dot(weights_0,scaled_in)+offset_0)
    weights_1 = theano.tensor.matrix("w1")
    offset_1 = theano.tensor.vector("off1")
    
    scaled_out = theano.tensor.batched_dot(weights_1,hidden_out)+offset_1
    uncenter = theano.tensor.vector("uncent")
    unscale = theano.tensor.vector("unscale")

    nn_out = theano.function([features,centering,scaling,weights_0,offset_0,weights_1,offset_1,uncenter,unscale], (scaled_out+1)/2*unscale+uncenter)



